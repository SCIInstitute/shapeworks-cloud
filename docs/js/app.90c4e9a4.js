(function(e){function t(t){for(var n,s,l=t[0],o=t[1],c=t[2],d=0,v=[];d<l.length;d++)s=l[d],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&v.push(i[s][0]),i[s]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);u&&u(t);while(v.length)v.shift()();return r.push.apply(r,c||[]),a()}function a(){for(var e,t=0;t<r.length;t++){for(var a=r[t],n=!0,l=1;l<a.length;l++){var o=a[l];0!==i[o]&&(n=!1)}n&&(r.splice(t--,1),e=s(s.s=a[0]))}return e}var n={},i={app:0},r=[];function s(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=n,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(a,n,function(t){return e[t]}.bind(null,n));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],o=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var u=o;r.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("cd49")},"0401":function(e,t,a){},"0613":function(e,t,a){"use strict";a.d(t,"vb",(function(){return l})),a.d(t,"Fb",(function(){return o})),a.d(t,"B",(function(){return c})),a.d(t,"Ub",(function(){return u})),a.d(t,"e",(function(){return d})),a.d(t,"Jb",(function(){return v})),a.d(t,"f",(function(){return p})),a.d(t,"Kb",(function(){return b})),a.d(t,"K",(function(){return f})),a.d(t,"i",(function(){return m})),a.d(t,"d",(function(){return g})),a.d(t,"n",(function(){return h})),a.d(t,"Hb",(function(){return _})),a.d(t,"Ib",(function(){return y})),a.d(t,"yb",(function(){return j})),a.d(t,"zb",(function(){return O})),a.d(t,"Eb",(function(){return w})),a.d(t,"Ab",(function(){return S})),a.d(t,"V",(function(){return x})),a.d(t,"j",(function(){return D})),a.d(t,"m",(function(){return k})),a.d(t,"z",(function(){return P})),a.d(t,"wb",(function(){return C})),a.d(t,"nb",(function(){return E})),a.d(t,"S",(function(){return M})),a.d(t,"T",(function(){return I})),a.d(t,"Ob",(function(){return A})),a.d(t,"Nb",(function(){return T})),a.d(t,"q",(function(){return L})),a.d(t,"s",(function(){return R})),a.d(t,"r",(function(){return F})),a.d(t,"jb",(function(){return W})),a.d(t,"lb",(function(){return N})),a.d(t,"kb",(function(){return z})),a.d(t,"h",(function(){return K})),a.d(t,"C",(function(){return V})),a.d(t,"u",(function(){return U})),a.d(t,"x",(function(){return B})),a.d(t,"y",(function(){return $})),a.d(t,"g",(function(){return G})),a.d(t,"A",(function(){return q})),a.d(t,"w",(function(){return J})),a.d(t,"v",(function(){return H})),a.d(t,"D",(function(){return Z})),a.d(t,"ib",(function(){return Y})),a.d(t,"l",(function(){return X})),a.d(t,"k",(function(){return Q})),a.d(t,"cb",(function(){return ee})),a.d(t,"Z",(function(){return te})),a.d(t,"Y",(function(){return ae})),a.d(t,"W",(function(){return ne})),a.d(t,"eb",(function(){return ie})),a.d(t,"db",(function(){return re})),a.d(t,"X",(function(){return se})),a.d(t,"fb",(function(){return le})),a.d(t,"gb",(function(){return oe})),a.d(t,"ab",(function(){return ce})),a.d(t,"bb",(function(){return ue})),a.d(t,"I",(function(){return de})),a.d(t,"F",(function(){return ve})),a.d(t,"E",(function(){return pe})),a.d(t,"H",(function(){return be})),a.d(t,"U",(function(){return fe})),a.d(t,"xb",(function(){return me})),a.d(t,"Tb",(function(){return ge})),a.d(t,"G",(function(){return he})),a.d(t,"J",(function(){return _e})),a.d(t,"Pb",(function(){return ye})),a.d(t,"Qb",(function(){return je})),a.d(t,"M",(function(){return Oe}));var n=a("188c"),i=a("2b0e"),r=a("dad5"),s=a("4597");a.d(t,"c",(function(){return s["a"]})),a.d(t,"o",(function(){return s["b"]})),a.d(t,"p",(function(){return s["c"]})),a.d(t,"t",(function(){return s["d"]})),a.d(t,"L",(function(){return s["e"]})),a.d(t,"N",(function(){return s["f"]})),a.d(t,"O",(function(){return s["g"]})),a.d(t,"P",(function(){return s["h"]})),a.d(t,"Q",(function(){return s["i"]})),a.d(t,"R",(function(){return s["j"]})),a.d(t,"hb",(function(){return s["m"]})),a.d(t,"ob",(function(){return s["n"]})),a.d(t,"pb",(function(){return s["o"]})),a.d(t,"qb",(function(){return s["p"]})),a.d(t,"rb",(function(){return s["q"]})),a.d(t,"sb",(function(){return s["r"]})),a.d(t,"tb",(function(){return s["s"]})),a.d(t,"ub",(function(){return s["t"]})),a.d(t,"Bb",(function(){return s["u"]})),a.d(t,"Cb",(function(){return s["v"]})),a.d(t,"Db",(function(){return s["w"]})),a.d(t,"Gb",(function(){return s["x"]})),a.d(t,"Lb",(function(){return s["y"]})),a.d(t,"Mb",(function(){return s["z"]})),a.d(t,"Rb",(function(){return s["A"]})),a.d(t,"Sb",(function(){return s["B"]})),a.d(t,"a",(function(){return r["b"]})),a.d(t,"b",(function(){return r["c"]})),a.d(t,"mb",(function(){return r["e"]})),a.d(t,"Vb",(function(){return r["f"]}));const l=Object(i["ref"])(!1),o=Object(i["ref"])(!1),c=Object(i["ref"])(),u=Object(i["ref"])(),d=Object(i["ref"])([]),v=Object(i["ref"])(),p=Object(i["ref"])([]),b=Object(i["ref"])(),f=Object(i["ref"])(),m=Object(i["ref"])([]),g=Object(i["ref"])([]),h=Object(i["ref"])([]),_=Object(i["ref"])([]),y=Object(i["ref"])([]),j=Object(i["ref"])(n["a"].newInstance()),O=Object(i["ref"])(2),w=Object(i["ref"])([]),S=Object(i["ref"])({}),x=Object(i["ref"])({}),D=Object(i["ref"])(),k=Object(i["ref"])(),P=Object(i["ref"])(),C=Object(i["ref"])(),E=Object(i["ref"])(["Original"]),M=Object(i["ref"])(),I=Object(i["ref"])(45),A=Object(i["ref"])(!1),T=Object(i["ref"])(!1),L=Object(i["ref"])({}),R=Object(i["ref"])({}),F=Object(i["ref"])({}),W=Object(i["ref"])([]),N=Object(i["ref"])(!0),z=Object(i["ref"])(2),K=Object(i["ref"])(),V=Object(i["ref"])(),U=Object(i["ref"])([]),B=Object(i["ref"])(!0),$=Object(i["ref"])([]),G=Object(i["ref"])(),q=Object(i["ref"])(),J=Object(i["ref"])(3),H=Object(i["ref"])(!0),Z=Object(i["ref"])({}),Y=Object(i["ref"])(),X=Object(i["ref"])(0),Q=Object(i["ref"])(!1),ee=Object(i["ref"])(!1),te=Object(i["ref"])(!1),ae=Object(i["ref"])(!1),ne=Object(i["ref"])("Z"),ie=Object(i["ref"])({x:0,y:0,z:0}),re=Object(i["ref"])({x:[0,1],y:[0,1],z:[0,1]}),se=Object(i["ref"])({x:[0,1],y:[0,1],z:[0,1]}),le=Object(i["ref"])(0),oe=Object(i["ref"])([0,1]),ce=Object(i["ref"])(0),ue=Object(i["ref"])([0,1]),de=Object(i["ref"])(),ve=Object(i["ref"])(-1),pe=Object(i["ref"])("Generated"),be=Object(i["ref"])(!1),fe=Object(i["ref"])({}),me=Object(i["ref"])({}),ge=Object(i["ref"])(!0),he=Object(i["ref"])([0,1]),_e=Object(i["ref"])(1),ye=Object(i["ref"])(!0),je=Object(i["ref"])(r["c"].NAME),Oe=Object(i["ref"])({private:!1,readonly:!1})},"06eb":function(e,t,a){},1:function(e,t){},"12d3":function(e,t,a){"use strict";a("907a"),a("986a"),a("1d02"),a("3c5d"),a("6ce5"),a("2834"),a("4ea1");var n=a("eb45");t["a"]=async function(e){if(!e)return n["a"].newInstance();const t=await fetch(e),a=await t.text(),i=a.trim().split("\n"),r=i.map(e=>e.trim().split(/\s+/).map(e=>parseFloat(e))).flat(),s=Float32Array.from(r),l=n["a"].newInstance();return l.getPoints().setData(s,3),l}},"13ec":function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"g",(function(){return i})),a.d(t,"h",(function(){return r})),a.d(t,"b",(function(){return s})),a.d(t,"d",(function(){return l})),a.d(t,"f",(function(){return o})),a.d(t,"a",(function(){return c})),a.d(t,"e",(function(){return u}));a("13d5"),a("14d9");function n(e,t){return e.reduce((function(e,a){return(e[a[t]]=e[a[t]]||[]).push(a),e}),{})}function i(e){return e.split("T")[0]}function r(e){const t=e.split("?")[0].split("/");return t[t.length-1]}function s(e,t,a=!1){let n=0,i=0;for(let r=0;r<e.length;r++){const a=t[r]-e[r];n+=a,i+=a*a}return a&&n<0?-Math.sqrt(i):Math.sqrt(i)}function l(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:[0,0,0]}function o(e){const t=e.map(e=>{const t=e.toString(16);return 1==t.length?"0"+t:t});return"#"+t.join("")}function c(e,t){return Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)+Math.pow(e.z-t.z,2)}async function u(e){return fetch(e).then(e=>e.text()).then(e=>{const t=e.split("\n").slice(0,-1),a=[];for(let n=1;n<t.length;n++){const e={},i=t[n].split(",");for(let t=0;t<i.length;t++)e[t]=isNaN(parseFloat(i[t]))?i[t]:parseFloat(i[t]);a.push(e)}return a})}},"15e2":function(e,t,a){"use strict";a("bb85")},1726:function(e,t,a){},"1d10":function(e,t,a){"use strict";a("95ed")},2226:function(e,t,a){},"2aea":function(e,t,a){"use strict";a("577f")},"2cbc":function(e,t,a){"use strict";a("a1af")},"360a":function(e,t,a){"use strict";a("f525")},"39ac":function(e,t,a){"use strict";a("85ce")},"3ea8":function(e,t,a){"use strict";a("867c")},4251:function(e,t,a){"use strict";a("791f")},4597:function(e,t,a){"use strict";a.d(t,"n",(function(){return b})),a.d(t,"f",(function(){return f})),a.d(t,"r",(function(){return m})),a.d(t,"s",(function(){return g})),a.d(t,"x",(function(){return h})),a.d(t,"q",(function(){return _})),a.d(t,"p",(function(){return y})),a.d(t,"t",(function(){return j})),a.d(t,"o",(function(){return O})),a.d(t,"m",(function(){return w})),a.d(t,"A",(function(){return S})),a.d(t,"e",(function(){return k})),a.d(t,"a",(function(){return P})),a.d(t,"B",(function(){return C})),a.d(t,"d",(function(){return E})),a.d(t,"c",(function(){return M})),a.d(t,"b",(function(){return I})),a.d(t,"l",(function(){return A})),a.d(t,"C",(function(){return T})),a.d(t,"k",(function(){return L})),a.d(t,"i",(function(){return R})),a.d(t,"z",(function(){return F})),a.d(t,"v",(function(){return W})),a.d(t,"w",(function(){return N})),a.d(t,"j",(function(){return z})),a.d(t,"g",(function(){return K})),a.d(t,"y",(function(){return V})),a.d(t,"u",(function(){return U})),a.d(t,"h",(function(){return $}));a("14d9");var n=a("0613"),i=a("99ce"),r=a("12d3"),s=a("d30b");function l(e){const t=s["a"].newInstance();return"vtkPolyData"==e.getClassName()?t.setInputData(e):"vtkImageData"==e.getClassName()&&console.error("Unexpected analysis mesh type"),t}var o=a("db11"),c=a("c31b"),u=a("dad5"),d=a("13ec"),v=a("5f86");const p=()=>{n["Ib"].value=[],n["nb"].value=["Original"],n["jb"].value=[],n["D"].value={},n["ib"].value=void 0,n["zb"].value=2,n["j"].value=void 0,n["l"].value=0,n["m"].value=void 0,n["z"].value=void 0,n["wb"].value=void 0,n["S"].value=void 0,n["T"].value=45,n["Ob"].value=!1,n["Nb"].value=!1,n["q"].value={},n["s"].value={},n["r"].value={},n["l"].value=0,n["k"].value=!1},b=async e=>{var t;(null===(t=n["Jb"].value)||void 0===t?void 0:t.id)!=e&&(n["vb"].value=!0,n["Jb"].value=await Object(c["i"])(e),n["vb"].value=!1)};async function f(){const e=v["a"].currentRoute.params.searchText;n["vb"].value=!0,n["e"].value=(await Object(c["j"])(e)).sort((e,t)=>e.created<t.created?1:e.created>t.created?-1:0),n["vb"].value=!1}const m=async e=>{Object(c["y"])(e).then(e=>{e.file?Object(c["r"])(e.file).then(t=>{e.file_contents=t,n["Kb"].value=e}):n["Kb"].value=e}),x()},g=async e=>{const t=v["a"].currentRoute.params.searchText;n["vb"].value=!0,n["f"].value=(await Object(c["s"])(t,e)).sort((e,t)=>e.created<t.created?1:e.created>t.created?-1:0),n["vb"].value=!1},h=e=>{e&&(p(),n["Kb"].value=n["f"].value.find(t=>t.id==e))},_=async(e,t)=>{var a;let i=await Object(c["q"])(e,t,null===(a=n["Kb"].value)||void 0===a?void 0:a.id);i&&i.length>0?(i=i[0],n["Ab"].value[e]||(n["Ab"].value[e]={}),n["Ab"].value[e][t]=i):n["Ab"].value[e]&&n["Ab"].value[e][t]&&(n["Ab"].value[e][t]=void 0)},y=async(e,t)=>{var a;let i=await Object(c["p"])(e,t,null===(a=n["Kb"].value)||void 0===a?void 0:a.id);i&&i.length>0?(i=i[0],n["V"].value[e]||(n["V"].value[e]={}),n["V"].value[e][t]=i):n["V"].value[e]&&n["V"].value[e][t]&&(n["V"].value[e][t]=void 0)},j=async(e,t)=>{var a;n["Kb"].value&&(n["Eb"].value=await Object(c["t"])(e,t,null===(a=n["Kb"].value)||void 0===a?void 0:a.id))},O=async()=>{if(n["Kb"].value){const e=await Promise.all([await Object(c["l"])(n["Kb"].value.id),await Object(c["k"])(n["Kb"].value.id),await Object(c["o"])(n["Kb"].value.id),await Object(c["n"])(n["Kb"].value.id),await Object(c["m"])(n["Kb"].value.id)]);n["I"].value={result:e[0][0],aug_pairs:e[1],training_pairs:e[2],images:e[3],test_pairs:e[4]}}};function w(e){var t,a;let n;switch(e){case"groom":return n=null===(t=u["e"].value)||void 0===t?void 0:t.find(e=>"Groomed"===e.name),!!n&&n.available();case"optimize":return n=null===(a=u["e"].value)||void 0===a?void 0:a.find(e=>"Particles"===e.name),!!n&&n.available();case"analyze":return!1;default:return!1}}async function S(e,t){var a,i,r,s,l;const o=null===(a=n["Kb"].value)||void 0===a?void 0:a.id;if(o)switch(e){case"groom":return n["nb"].value=n["nb"].value.filter(e=>"Groomed"!==e),null===(i=await Object(c["w"])(o,t))||void 0===i?void 0:i.data;case"optimize":return n["nb"].value=n["nb"].value.filter(e=>"Particles"!==e),null===(r=await Object(c["x"])(o,t))||void 0===r?void 0:r.data;case"analyze":return n["nb"].value=n["nb"].value.filter(e=>"Reconstructed"!==e),null===(s=await Object(c["b"])(o,t))||void 0===s?void 0:s.data;case"deepssm":return null===(l=await Object(c["e"])(o,t))||void 0===l?void 0:l.data;default:break}}async function x(){n["ib"].value&&clearInterval(n["ib"].value),n["ib"].value=setInterval(D,1e3)}function D(){if(n["Kb"].value){const e=n["Kb"].value.id;Object(c["v"])(e).then(t=>{if(t){const a={};t.forEach(e=>{!e.name||e.abort||e.error||100===e.percent_complete||(a[""+e.name]=e)}),n["D"].value={...n["D"].value,[e]:a}}})}}async function k(e){if(!n["Kb"].value)return;const t=await Object(c["y"])(n["Kb"].value.id);let a="",i=void 0;switch(e){case"groom":a="Groomed",i=y;break;case"optimize":a="Particles",i=_;break;case"analyze":a="Reconstructed",i=j,n["j"].value=null===t||void 0===t?void 0:t.last_cached_analysis,n["j"].value&&n["j"].value.good_bad_angles&&(n["S"].value=n["j"].value.good_bad_angles);break;case"deepssm":i=O;break}if(a&&i)if(a){await Promise.all(n["d"].value.map(e=>i?i(e.type,e.id):void 0)),n["q"].value=Object.fromEntries(Object.entries(n["q"].value).filter(([e])=>!e.includes(a)));const e=u["e"].value.find(e=>e.name===a);null!==e&&void 0!==e&&e.available()&&!n["nb"].value.includes(a)&&(n["nb"].value=[...n["nb"].value,a])}else i()}async function P(e){e&&e.id&&Object(c["a"])(e.id)}async function C(e){if(!n["Kb"].value)return;n["F"].value=-1;const t=await Object(c["y"])(n["Kb"].value.id);switch(e){case"analyze":t&&(n["j"].value=t.last_cached_analysis,n["j"].value&&n["j"].value.good_bad_angles&&(n["S"].value=n["j"].value.good_bad_angles))}}function E(e,t,a){const n=[];let i=[];for(let l=0;l<t.length;l+=3){const e=t.slice(l,l+3),i=a.slice(l,l+3),r=Object(d["b"])(e,i,!0);n.push([...e,r])}const r=e.getInputData().getPoints().getData(),s=e.getInputData().getPointData().getArrayByName("Normals").getData();return i=Array.from([...Array(r.length/3).keys()].map(e=>{let t=0;const a=r.slice(3*e,3*e+3),i=s.slice(3*e,3*e+3),l=n.map((e,t)=>[Object(d["b"])(e.slice(0,3),a),t,...e]).sort((e,t)=>e[0]-t[0]).slice(0,10),o=l[0][1];return n[o].length<5&&n[o].push(...i),t=l[0][5],l.slice(1).forEach(e=>{const a=1/e[0];t=t*(1-a)+e[5]*a}),t/10+.5})),{colorValues:i,vectorValues:n}}function M(e,t,a){n["r"].value[a]=e,n["s"].value[a]=t}async function I(e){if(void 0!==e){const t=await Promise.all(null===e||void 0===e?void 0:e.map(async e=>await Promise.all(e.map(async(e,t)=>{if(n["wb"].value&&n["wb"].value.length>t){const a=e.particles;if(!n["r"].value[a]){const a=await Object(r["a"])(n["wb"].value[t]),s=await Object(r["a"])(e.particles),o=await Object(i["a"])(e.file,"current_mesh.vtk");return{compareTo:{points:a.getPoints().getData(),particleUrl:e},current:{points:s.getPoints().getData(),mapper:l(o),particleUrl:e.particles}}}}}))));t.forEach(e=>{void 0!==e&&e.forEach(e=>{if(e){const{current:t,compareTo:a}=e,n=E(t.mapper,t.points,a.points);M(n.colorValues,n.vectorValues,t.particleUrl)}})})}}function A(e,t){return n["Ib"].value.some(a=>a.subject===e&&a.anatomy_type.replace("anatomy_","")===t)}function T(e,t){const a=n["d"].value.find(a=>a.subject===e&&a.anatomy_type.replace("anatomy_","")===t);a&&(n["Ib"].value.includes(a)?n["Ib"].value=n["Ib"].value.filter(e=>e!==a):n["Ib"].value=[...n["Ib"].value,a])}function L(e,t){return{subjectName:e.name,domain:t.domain,widgetID:t.id}}function R(e,t){if(n["h"].value&&n["h"].value[e.name]&&n["h"].value[e.name][t.domain])return n["h"].value[e.name][t.domain][t.id]}function F(e,t,a){n["h"].value||(n["h"].value={}),n["h"].value[e.name]||(n["h"].value[e.name]={}),n["h"].value[e.name][t.domain]||(n["h"].value[e.name][t.domain]={}),n["h"].value[e.name][t.domain][t.id]=a}function W(){const e={};n["jb"].value=n["jb"].value.map((t,a)=>(void 0!==t.id&&(e[t.id]=a),Object.assign(t,{id:a}))),n["h"].value&&(n["h"].value=Object.fromEntries(Object.entries(n["h"].value).map(([t,a])=>[t,Object.fromEntries(Object.entries(a).map(([t,a])=>(a=Object.fromEntries(Object.entries(a).filter(([t])=>Object.keys(e).includes(t)).map(([t,a])=>[e[t],a])),[t,a])))])))}function N(){const e=!1,t=n["jb"].value.map(e=>{const t=n["i"].value.filter(t=>!!R(t,e)).length;return t!=e.num_set&&(e.num_set=t),e});e&&(n["jb"].value=t)}async function z(){var e;if(n["h"].value={},null!==(e=n["Kb"].value)&&void 0!==e&&e.landmarks){n["jb"].value=n["Kb"].value.landmarks_info.map((e,t)=>(e.id||(e.id=t),e.name||(e.name="L"+t),e.color||(e.color=u["a"][t%u["a"].length]),e.color.toString().includes("#")&&(e.color=Object(d["d"])(e.color.toString())),e.num_set=0,e));for(let e=0;e<n["Kb"].value.landmarks.length;e++){const t=n["Kb"].value.landmarks[e],a=n["i"].value.find(e=>e.id===t.subject),i=await Object(r["a"])(t.file),s=i.getPoints().getData(),l=[];for(let e=0;e<s.length;e+=3){const t=s.slice(e,e+3);l.push(t)}const o=n["jb"].value.filter(e=>e.domain===t.anatomy_type.replace("anatomy_",""));l.forEach((e,t)=>{const n=o[t];F(a,n,e)})}n["h"].value=Object.assign({},n["h"].value),N()}}function K(e,t){if(n["g"].value&&n["g"].value[e.name]&&n["g"].value[e.name][t.domain])return n["g"].value[e.name][t.domain][t.id]}function V(e,t,a){n["g"].value||(n["g"].value={}),n["g"].value[e.name]||(n["g"].value[e.name]={}),n["g"].value[e.name][t.domain]||(n["g"].value[e.name][t.domain]={}),n["g"].value[e.name][t.domain][t.id]=a,n["g"].value=Object.assign({},n["g"].value),B()}function U(){const e={};n["u"].value=n["u"].value.map((t,a)=>(void 0!==t.id&&(e[t.id]=a),Object.assign(t,{id:a}))),n["g"].value&&(n["g"].value=Object.fromEntries(Object.entries(n["g"].value).map(([t,a])=>[t,Object.fromEntries(Object.entries(a).map(([t,a])=>(a=Object.fromEntries(Object.entries(a).filter(([t])=>Object.keys(e).includes(t)).map(([t,a])=>[e[t],a])),[t,a])))])))}function B(){const e=!1,t=n["u"].value.map(e=>{const t=n["i"].value.filter(t=>!!K(t,e)).length;return t!=e.num_set&&(e.num_set=t),e});e&&(n["u"].value=t)}async function $(){var e;if(n["g"].value={},n["u"].value=[],null!==(e=n["Kb"].value)&&void 0!==e&&e.constraints){for(let e=0;e<n["Kb"].value.constraints.length;e++){var t;const a=n["Kb"].value.constraints[e],i=n["i"].value.find(e=>e.id===a.subject),r=(null===(t=a.anatomy_type)||void 0===t?void 0:t.replace("anatomy_",""))||"0";if(i){const e=await Object(o["b"])(a.file);["plane","paint"].forEach(t=>{const a=e.filter(e=>e.type===t),s=n["u"].value.filter(e=>e.type===t&&e.domain===r);for(let e=0;e<a.length;e++){let l;const o=a[e];e>=s.length?(l={id:n["u"].value.length,type:t,name:o.name,domain:r},n["u"].value.push(l)):l=s[e],l&&V(i,l,o)}})}}n["g"].value=Object.assign({},n["g"].value),B()}}},"577f":function(e,t,a){},"59f6":function(e,t,a){"use strict";a("e5b9")},"5cf4":function(e,t,a){},"5f86":function(e,t,a){"use strict";var n=a("2b0e"),i=a("8c4f"),r=a("b0af"),s=a("132d"),l=a("da13"),o=a("5d23"),c=a("f774"),u=a("a797"),d=a("490a"),v=a("71a3"),p=a("c671"),b=a("fe57"),f=a("3a2f"),m=function(){var e=this,t=e._self._c;return e.selectedDataset?t("div",{staticClass:"content-area",staticStyle:{height:"100%"}},[t(c["a"],{ref:"drawer",attrs:{width:e.drawerWidth,permanent:"",absolute:""}},[t(l["a"],[t(o["c"],{staticClass:"text-h6"},[t(f["a"],{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function({on:a,attrs:n}){return[t(s["a"],e._g(e._b({attrs:{dark:""},on:{click:e.toSelectPage}},"v-icon",n,!1),a),[e._v(" mdi-arrow-left ")])]}}],null,!1,1881277058)},[t("span",[e._v("Return to dataset/project selection")])]),e._v(" Dataset: "+e._s(e.selectedDataset.name)+" ")],1)],1),t(l["a"],[t(s["a"]),t(b["a"],{attrs:{"fixed-tabs":""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[t(v["a"],{attrs:{href:"#data"}},[e._v("Data")]),t(p["a"],{attrs:{value:"data"}},[t("data-list",{attrs:{dataset:e.dataset,autoSelectOne:""}})],1),t(v["a"],{attrs:{href:"#info"}},[e._v("Info")]),t(p["a"],{attrs:{value:"info"}},[e.selectedProject&&e.selectedProject.readonly?t("span",{staticClass:"red--text pa-3"},[e._v(" This project is read only. No operations may be performed. ")]):t("info-tab")],1),t(v["a"],{attrs:{href:"#groom"}},[e._v("Groom")]),t(p["a"],{attrs:{value:"groom"}},[e.selectedProject&&e.selectedProject.readonly?t("span",{staticClass:"red--text pa-3"},[e._v(" This project is read only. No grooming or optimizing may be performed. ")]):t("tab-form",{attrs:{form:"groom"},on:{change:e.refreshRender}})],1),t(v["a"],{attrs:{href:"#optimize"}},[e._v("Optimize")]),t(p["a"],{attrs:{value:"optimize"}},[e.selectedProject&&e.selectedProject.readonly?t("span",{staticClass:"red--text pa-3"},[e._v(" This project is read only. No grooming or optimizing may be performed. ")]):t("tab-form",{attrs:{form:"optimize",prerequisite:()=>e.jobAlreadyDone("groom"),prerequisite_unfulfilled:"Perform a groom operation before optimizing."},on:{change:e.refreshRender}})],1),t(v["a"],{attrs:{href:"#analyze"}},[e._v("Analyze")]),t(p["a"],{attrs:{value:"analyze"}},[t("analysis-tab",{attrs:{currentTab:e.tab||""},on:{change:e.refreshRender}})],1),t(v["a"],{attrs:{href:"#deepssm"}},[e._v("DeepSSM")]),t(p["a"],{attrs:{value:"deepssm"}},[t("DeepSSMTab",{on:{change:e.refreshRender}})],1)],1)],1),t("br")],1),t(r["a"],{staticClass:"px-3 render-controls",style:e.renderAreaStyle},[t("render-controls",{attrs:{currentTab:e.tab||""},on:{change:e.refreshRender}})],1),t(r["a"],{staticClass:"pa-3",style:e.renderAreaStyle},[e.selectedDataObjects.length>0||e.analysisFilesShown&&e.analysisFilesShown.length?[t("shape-viewer",{attrs:{data:e.renderData,metaData:e.renderMetaData,rows:e.rows,columns:e.cols,"glyph-size":e.particleSize,currentTab:e.tab||"",drawerWidth:e.drawerWidth}})]:t("span",[e._v("Select any number of data objects")]),t(u["a"],{attrs:{absolute:"",value:!e.loadingState&&e.renderLoading,"stop-propagation":!0}},[t(d["a"],{attrs:{indeterminate:""}})],1)],2)],1):e._e()},g=[],h=(a("14d9"),a("13d5"),a("2ef0")),_=a.n(h),y=a("99ce"),j=a("12d3"),O=a("13ec"),w=a("dc22"),S=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{directives:[{def:w["a"],name:"resize",rawName:"v-resize",value:e.resize,expression:"resize"}],ref:"vtk",staticClass:"render-area"},[t("canvas",{ref:"labels",staticClass:"labels-canvas"}),e.showColorScale?t("div",{ref:"colors",staticClass:"color-scales"}):e._e(),e.showColorScale?t("div",{ref:"colorsTitle",staticClass:"color-scale-title"}):e._e(),e.showColorScale?t("div",{ref:"colorsLabels",staticClass:"color-scale-labels"}):e._e()])},x=[],D=(a("02f0"),a("0cf4")),k=a("4c40"),P=a("82f7"),C=a("8f5f"),E=a("d1f3"),M=a("a2a7"),I=(a("907a"),a("986a"),a("1d02"),a("3c5d"),a("6ce5"),a("2834"),a("4ea1"),a("d30b")),A=a("eb45"),T=a("1c1c"),L=a("af93"),R=a("c3ab"),F=a("efce"),W=a("5977"),N=a("7b05"),z=a("133d"),K=a("c5b38"),V=a("ad94"),U=a("3c52"),B=a("97dc"),$=a("3832"),G=a("5275"),q=a("0613"),J=a("dad5"),H=a("bd3d"),Z=a("c457"),Y=a("67d0"),X=a("8c23"),Q=a("4daf"),ee=a("b946");const te=Object(n["ref"])({}),ae=Object(n["ref"])({}),ne=Object(n["ref"])({}),ie=Object(n["ref"])({}),re=Object(n["ref"])({}),se=Object(n["ref"])({});var le={initializeWidgets(){this.vtk.widgetManagers={},Object.entries(this.vtk.renderers).forEach(([e,t])=>{te.value[e]={};const a=Z["a"].newInstance();a.setRenderer(t),a.disablePicking(),this.vtk.widgetManagers[e]=a,t.getActors().forEach(t=>{var n;const i=null===(n=t.getMapper())||void 0===n||null===(n=n.getInputData())||void 0===n||null===(n=n.getFieldData())||void 0===n||null===(n=n.getArrayByName("domain"))||void 0===n?void 0:n.getData()[0];if(!te.value[e][i]){const a=H["a"].newInstance();a.getPicker().addPickList(t),te.value[e][i]=a}if(q["nb"].value.includes("Landmarks")){const t=ie.value[e];t&&Object.values(t).forEach(e=>{Object.values(e).forEach(e=>{const t=a.addWidget(e);t.setScaleInPixels(!1),t.onEndInteractionEvent(()=>{this.seedWidgetEndInteraction(e)})})})}if(q["nb"].value.includes("Constraints")){this.initializeConstraintColormap(t);const n=re.value[e];n&&Object.values(n).forEach(e=>{Object.values(e).forEach(e=>{const t=a.addWidget(e);this.stylePlaneWidget(t),t.onEndInteractionEvent(()=>{this.planeWidgetEndInteraction(e)})})})}})}),q["nb"].value.includes("Landmarks")&&this.landmarkInfoUpdated(q["jb"].value),q["nb"].value.includes("Constraints")&&this.constraintInfoUpdated(q["u"].value)},initializeConstraintColormap(e){const t=e.getMapper();if(!t.setLookupTable)return;const a=E["a"].newInstance();let n=[255,255,255];e.getProperty()&&e.getProperty().getColor&&(n=e.getProperty().getColor()),a.addRGBPoint(1,...n),a.addRGBPoint(0,.5,.5,.5),a.setMappingRange(0,1),a.updateRange(),t.setLookupTable(a),t.setColorByArrayName("color");const i=t.getInputData(),r=i.getPoints(),s=N["a"].newInstance({name:"color",values:Array.from({length:r.getNumberOfPoints()},()=>1)});i.getPointData().addArray(s)},getWidgetManager(e){return this.vtk.widgetManagers[e]},getManipulator(e,t){return te.value[e]||(te.value[e]={}),te.value[e][t]},getDataKDTree(e,t,a){if(ae.value[e]||(ae.value[e]={}),!ae.value[e][t]){const{points:n}=a.data.field,i=n.map((e,t)=>({x:e[0],y:e[1],z:e[2],i:t}));ae.value[e][t]=new ee["kdTree"](i,O["a"],["x","y","z","i"])}return ae.value[e][t]},getShapeKDTree(e,t,a){if(ne.value[e]||(ne.value[e]={}),!ne.value[e][t]){const n=Array.prototype.slice.call(a.getPoints().getData()),i=Array.from({length:n.length/3},()=>n.splice(0,3)),r=i.map(e=>({x:e[0],y:e[1],z:e[2]}));ne.value[e][t]=new ee["kdTree"](r,O["a"],["x","y","z"])}return ne.value[e][t]},getSeedWidget(e,t,a){return ie.value[e]||(ie.value[e]={}),ie.value[e][t]||(ie.value[e][t]={}),ie.value[e][t][a.id]||this.createSeedWidget(e,t,a),ie.value[e][t][a.id]},getPlaneWidget(e,t,a){return re.value[e]||(re.value[e]={}),re.value[e][t]||(re.value[e][t]={}),re.value[e][t][a.id]||this.createPlaneWidget(e,t,a),re.value[e][t][a.id]},getPaintWidget(e,t,a,n){return se.value[e]||(se.value[e]={}),se.value[e][t]||(se.value[e][t]={}),this.createPaintWidget(e,t,a,n),se.value[e][t][a.id]},createSeedWidget(e,t,a){const n=this.vtk.renderers[e],i=this.getManipulator(e,t),r=this.getWidgetManager(e);if(n&&i){const n=Y["a"].newInstance(),s=r.addWidget(n);n.setManipulator(i),s.setScaleInPixels(!1),s.onEndInteractionEvent(()=>{this.seedWidgetEndInteraction(n)}),ie.value[e][t][a.id]=n}},createPlaneWidget(e,t,a){const n=this.vtk.renderers[e],i=this.getManipulator(e,t),r=this.getWidgetManager(e);if(n&&i){const n=i.getPicker().getPickList();if(n.length>0){const i=n[0],s=i.getBounds(),l=Q["a"].newInstance();l.placeWidget(s),l.setPlaceFactor(2);const o=r.addWidget(l);o.getRepresentations()[0].setLabels({subject:e,domain:t}),this.stylePlaneWidget(o),o.onEndInteractionEvent(()=>{this.planeWidgetEndInteraction(l)}),re.value[e][t][a.id]=l}}},createPaintWidget(e,t,a,n){const i=this.getWidgetManager(e),r=this.getManipulator(e,t);if(r){const s=X["a"].newInstance({manipulator:r}),l=i.addWidget(s);se.value[e][t][a.id]=s,l.onEndInteractionEvent(()=>{this.paintWidgetEndInteraction(s,n)})}},stylePlaneWidget(e){e.setHandleSizeRatio(.08),e.setAxisScale(.25),e.setRepresentationStyle({static:{outline:{opacity:0}}})},seedWidgetEndInteraction(e){Object.entries(ie.value).forEach(([t,a])=>{Object.entries(a).forEach(([a,n])=>{Object.entries(n).forEach(([n,i])=>{if(e===i){const i={domain:a,id:n},r=this.getWidgetManager(t),s=e.getWidgetState().getMoveHandle().getOrigin();if(s){r.releaseFocus(e);const a=Object(q["Q"])({name:t},i,s);a&&!a.some((e,t)=>s[t]!=e)||(Object(q["Mb"])({name:t},i,s),q["h"].value=Object.assign({},q["h"].value),Object(q["Db"])(),q["C"].value=void 0)}}})})})},planeWidgetEndInteraction(e){Object.entries(re.value).forEach(([t,a])=>{Object.entries(a).forEach(([a,n])=>{Object.entries(n).forEach(([n,i])=>{if(e===i){const i={domain:a,id:n},r=e.getWidgetState();Object(q["Lb"])({name:t},i,{type:"plane",data:{origin:r.getOrigin(),normal:r.getNormal()}}),this.updateConstraintColors()}})})})},paintWidgetEndInteraction(e,t){Object.entries(se.value).forEach(([a,n])=>{Object.entries(n).forEach(([n,i])=>{Object.entries(i).forEach(([i,r])=>{if(e===r){const r={domain:n,id:i},s=t.getPoints(),l=this.getShapeKDTree(a,n,t);let o=Object(q["O"])({name:a},r);if(!o){const e=s.getNumberOfPoints(),t=Array.from({length:e}).map((e,t)=>s.getPoint(t));o={type:"paint",data:{field:{points:t,scalars:Array.from({length:e}).fill(1)}}}}let c=[];e.getWidgetState().getTrailList().forEach(e=>{const t=e.getOrigin();t&&(c=[...c,...l.nearest({x:t[0],y:t[1],z:t[2]},s.getNumberOfPoints(),2*q["w"].value)])}),c.forEach(([{x:e,y:t,z:a}])=>{const n=o.data.field.points.findIndex(n=>n[0]===e&&n[1]===t&&n[2]===a);n>=0&&n<o.data.field.scalars.length&&(o.data.field.scalars[n]=q["v"].value?0:1)}),Object(q["Lb"])({name:a},r,o),this.updateConstraintColors()}})})})},landmarkInfoUpdated(e){const t=[];Object.entries(te.value).forEach(([a,n])=>{Object.entries(n).forEach(([n])=>{e.filter(e=>e.domain===n).forEach(e=>{const i=this.getSeedWidget(a,n,e),r=i.getWidgetState().getMoveHandle();t.push(i);const s=Object(q["Q"])({name:a},e);!s||r.getOrigin()&&!r.getOrigin().some((e,t)=>e!==s[t])||r.setOrigin(s),r.getColor3().some((t,a)=>t!==e.color[a])&&r.setColor3(...e.color),r.getScale1()!=q["kb"].value&&r.setScale1(q["kb"].value)})})}),ie.value=Object.fromEntries(Object.entries(ie.value).map(([e,a])=>[e,Object.fromEntries(Object.entries(a).map(([a,n])=>[a,Object.fromEntries(Object.entries(n).map(([a,n])=>t.includes(n)?[a,n]:(this.getWidgetManager(e).removeWidget(n),[a,void 0])))]))])),this.render()},landmarkSizeUpdated(){Object.values(ie.value).forEach(e=>{Object.values(e).forEach(e=>{Object.values(e).forEach(e=>{const t=e.getWidgetState().getMoveHandle();t.getScale1()!=q["kb"].value&&t.setScale1(q["kb"].value)})})}),this.render()},currentLandmarkPlacementUpdated(e){if(e){const t=e.subjectName,a=e.domain,n=e.widgetID,i=this.getWidgetManager(t),r=this.getManipulator(t,a);if(r){const e=this.getSeedWidget(t,a,{id:n,domain:a}),s=r.getPicker().getPickList();if(s.length>0){const t=s[0];e.placeWidget(t.getBounds()),i.grabFocus(e)}}}},constraintInfoUpdated(e){const t=[];Object.entries(te.value).forEach(([a,n])=>{Object.entries(n).forEach(([n])=>{e.filter(e=>e.domain===n).forEach(e=>{if("plane"===e.type){var i,r;const s=this.getPlaneWidget(a,n,e),l=s.getWidgetState(),o=Object(q["O"])({name:a},e);t.push(s);let c=null===o||void 0===o||null===(i=o.data)||void 0===i?void 0:i.origin;c&&l.getOrigin().some((e,t)=>e!=c[t])&&l.setOrigin(c);let u=null===o||void 0===o||null===(r=o.data)||void 0===r?void 0:r.normal;u&&l.getNormal().some((e,t)=>e!=u[t])&&l.setNormal(u),s.setVisibility(c&&u&&q["y"].value.includes(e.id))}})})}),re.value=Object.fromEntries(Object.entries(re.value).map(([e,a])=>[e,Object.fromEntries(Object.entries(a).map(([a,n])=>[a,Object.fromEntries(Object.entries(n).map(([a,n])=>t.includes(n)?[a,n]:(this.getWidgetManager(e).removeWidget(n),[a,void 0])))]))])),this.updateConstraintColors(),this.render()},constraintsShownUpdated(){this.constraintInfoUpdated(q["u"].value)},currentConstraintPlacementUpdated(e){if(e){const t=e.subjectName,a=e.domain,n=e.widgetID,i=this.getWidgetManager(t),r=this.getManipulator(t,a),s=q["u"].value.find(e=>e.id==n&&e.domain==a);if(r){const e=r.getPicker().getPickList();if(e.length>0){const l=e[0];if("plane"===(null===s||void 0===s?void 0:s.type)){const e=l.getBounds(),i=[(e[0]+e[1])/2,(e[2]+e[3])/2,(e[4]+e[5])/2],r=[0,0,1];Object(q["Lb"])({name:t},{id:n,domain:a},{type:"plane",data:{origin:i,normal:r}}),q["A"].value=void 0,this.constraintInfoUpdated(q["u"].value)}else if(r&&"paint"===(null===s||void 0===s?void 0:s.type)){const e=l.getMapper(),n=e.getInputData(),r=this.getPaintWidget(t,a,s,n);r.setRadius(q["w"].value),r.getWidgetState().getHandle().setVisible(!0),i.grabFocus(r),r.getWidgetState().setActive(!0)}}}}else Object.entries(se.value).forEach(([e,t])=>{const a=this.getWidgetManager(e);a&&Object.values(t).forEach(e=>{Object.values(e).forEach(e=>{e.getWidgetState().getHandle().setVisible(!1),e.getWidgetState().setActive(!1),a.releaseFocus(e)})})})},updateConstraintColors(){Object.entries(te.value).forEach(([e,t])=>{q["g"].value[e]&&Object.entries(t).forEach(([t,a])=>{const n=a.getPicker().getPickList();if(!n.length||!q["g"].value[e][t])return;const i=n[0],r=i.getMapper(),s=r.getInputData(),l=s.getPoints(),o=s.getPointData().getArrayByName("color");o.setData(new Uint8Array(l.getNumberOfPoints()).fill(1)),Object.entries(q["g"].value[e][t]).forEach(([a,n])=>{if(q["y"].value.includes(parseInt(a)))if("plane"===(null===n||void 0===n?void 0:n.type)){const{normal:e,origin:t}=n.data;let a=(e,t)=>e.map((a,n)=>e[n]*t[n]).reduce((e,t)=>e+t);for(let n=0;n<l.getNumberOfPoints();n++){const i=l.getPoint(n),r=o.getValue(n);if(1==r){const r=a(e,[t[0]-i[0],t[1]-i[1],t[2]-i[2]]);r<=0&&o.setValue(n,0)}}}else if("paint"===(null===n||void 0===n?void 0:n.type)){const{scalars:a}=n.data.field,i=this.getDataKDTree(e,t,n);if(a.length===l.getNumberOfPoints())for(let e=0;e<a.length;e++){const t=o.getValue(e);if(1==t){const t=l.getPoint(e),a={x:t[0],y:t[1],z:t[2]},r=i.nearest(a,1);if(r.length){const[t]=r[0];t.i&&t.i>=0&&t.i<n.data.field.scalars.length&&o.setValue(e,n.data.field.scalars[t.i])}}}}}),o.modified(),s.modified()})}),this.render()},watchWidgetStates(){Object(n["watch"])(q["jb"],_.a.debounce(this.landmarkInfoUpdated,1e3)),Object(n["watch"])(q["kb"],_.a.debounce(this.landmarkSizeUpdated,1e3)),Object(n["watch"])(q["C"],_.a.debounce(this.currentLandmarkPlacementUpdated,1e3)),Object(n["watch"])(q["u"],_.a.debounce(this.constraintInfoUpdated,1e3)),Object(n["watch"])(q["y"],_.a.debounce(this.constraintsShownUpdated,1e3)),Object(n["watch"])(q["A"],_.a.debounce(this.currentConstraintPlacementUpdated,1e3)),Object(n["watch"])(q["g"],_.a.debounce(this.updateConstraintColors,1e3))}},oe=a("563c"),ce=a("05b0"),ue=a("4967"),de=a("5fdf"),ve=a("17ac"),pe=a("e62d");const be=Object(n["ref"])([]);var fe={createSlice(e){const t=ce["a"].newInstance(),a=oe["a"].newInstance(),n=ve["a"].newInstance(),i=de["a"].newInstance(),r=I["a"].newInstance(),s=z["a"].newInstance(),l=ue["a"].newInstance(),o=K["a"].newInstance(),c=L["a"].newInstance(),u=z["a"].newInstance(),d=U["a"].newInstance();t.setMapper(a),e.addActor(t),i.setCutFunction(n),r.setInputConnection(i.getOutputPort()),s.setMapper(r);const v=s.getProperty();v.setRepresentation(pe["a"].Representation.WIREFRAME),v.setLighting(!1),v.setColor(0,1,0),v.setLineWidth(5),s.setVisibility(!1),o.setFormula({getArrays:()=>({input:[{location:G["b"].COORDINATE}],output:[{location:G["b"].POINT,name:"visible",dataType:Float32Array,attribute:B["a"].SCALARS,numberOfComponents:1}]}),evaluate:(e,t)=>{const[n]=e.map(e=>e.getData()),[i]=t.map(e=>e.getData()),r=l.getInputData().getBounds();let s,o;switch(a.getSlicingMode()){case 0:s="x",o=r.slice(0,2);break;case 1:s="y",o=r.slice(2,4);break;default:s="z",o=r.slice(4,6);break}const c=q["db"].value[s],u=q["eb"].value[s],d=c[1]-c[0],v=(o[1]-o[0])/d,p=(u-c[0])/(c[1]-c[0])*(o[1]-o[0])+o[0];for(var b=0;b<i.length;b++){const e=n.slice(3*b,3*b+3),t=e[a.getSlicingMode()];t>=p&&t<p+v&&(i[b]=1)}t.forEach(e=>e.modified())}}),d.setScaleModeToScaleByMagnitude(),d.setScaleFactor(this.glyphSize),d.setScaleArray("visible"),d.setInputConnection(o.getOutputPort(),0),d.setInputConnection(c.getOutputPort(),1),u.setMapper(d);const p={renderer:e,sliceActor:t,imageMapper:a,cutPlane:n,cutter:i,cutMapper:r,cutActor:s,cropFilter:l,particleFilter:o,filteredParticleMapper:d,filteredParticleActor:u};return be.value.push(p),p},updateSlice(e){const{sliceActor:t,imageMapper:a,renderer:n}=e;let i,r,s;const l=n.getActiveCamera(),o=t.getCenter(),c=l.getDistance();["X","L"].includes(q["W"].value)?(a.setSlicingMode("I"),a.setISlice(q["eb"].value.x),i=[o[0]+c,o[1],o[2]],r=[-1,0,0],s=[0,1,0]):["Y","P"].includes(q["W"].value)?(a.setSlicingMode("J"),a.setJSlice(q["eb"].value.y),i=[o[0],o[1]+c,o[2]],r=[0,-1,0],s=[0,0,-1]):["Z","S"].includes(q["W"].value)&&(a.setSlicingMode("K"),a.setKSlice(q["eb"].value.z),i=[o[0],o[1],o[2]+c],r=[0,0,-1],s=[0,1,0]),i&&r&&s&&(l.setPosition(...i),l.setDirectionOfProjection(...r),l.setViewUp(...s)),q["Z"].value&&this.updateCuttingPlane(e),n.resetCamera()},updateIntersection(e){const{renderer:t,cutter:a,cutActor:n,filteredParticleActor:i,particleFilter:r,cropFilter:s}=e,l=t.getActors().find(e=>"vtkImageSlice"!=e.getClassName());if(l){if(q["Y"].value){const e=s.getInputData().getBounds(),t=[...q["db"].value.x,...q["db"].value.y,...q["db"].value.z],a=.01,n=l.getBounds(),i=n.map((t,n)=>{const i=2*Math.floor(n/2),r=i+1,s=n%2===0?0-a:a;return(t-e[i])/(e[r]-e[i])+s}),r=i.map((e,a)=>{const n=2*Math.floor(a/2),i=n+1;return e*(t[i]-t[n])+t[n]});q["X"].value={x:r.slice(0,2),y:r.slice(2,4),z:r.slice(4,6)},q["eb"].value=Object.fromEntries(Object.entries(q["eb"].value).map(([e,t])=>{const[a,n]=q["X"].value[e];return t<a?[e,a]:t>n?[e,n]:[e,t]})),s.setCroppingPlanes(r)}else s.reset();a.setInputData(l.getMapper().getInputData()),n.setVisibility(q["Z"].value),n.setPosition(1,1,1),l.setVisibility(!q["Z"].value),t.addActor(n),t.resetCamera()}const o=t.getActors().map(e=>({mapper:e.getMapper(),actor:e})).find(({mapper:e})=>"vtkGlyph3DMapper"===e.getClassName());o?(o.actor.setVisibility(!q["Z"].value),r.setInputData(o.mapper.getInputData()),i.setVisibility(q["Z"].value),t.addActor(i)):i.setVisibility(!1),this.render()},updateCuttingPlane(e){var t;const{imageMapper:a,cutPlane:n,particleFilter:i}=e,r=a.getBoundsForSlice();let s=[r[0],r[2],r[4]],l=[0,0,0];l[a.getSlicingMode()]=1,n.setOrigin(s),n.setNormal(l),null===(t=i.getInputData())||void 0===t||t.modified()},updateGlyphSize(e){be.value.forEach(({filteredParticleMapper:t})=>{t.setScaleFactor(e)}),this.render()},addImage(e,t){let a=be.value.find(e=>e.renderer==t);a||(a=this.createSlice(t)),q["cb"].value=!0,a.cropFilter.setInputData(e),a.cropFilter.reset(),a.imageMapper.setInputConnection(a.cropFilter.getOutputPort()),a.sliceActor.getProperty().setColorWindow(q["fb"].value),a.sliceActor.getProperty().setColorLevel(q["ab"].value);const n=e.getPointData().getScalars().getRange();q["bb"].value=n,q["ab"].value=(n[1]-n[0])/2+n[0],q["gb"].value=[0,n[1]-n[0]],q["fb"].value=q["gb"].value[1];const i=e.getExtent();q["db"].value={x:[i[0],i[1]],y:[i[2],i[3]],z:[i[4],i[5]]},q["X"].value=q["db"].value,(q["Z"].value||q["Y"].value)&&this.imageViewIntersectModeUpdated(),this.updateSlice(a)},imageViewModeUpdated(){this.resize(),this.render()},imageViewAxisUpdated(){be.value.forEach(e=>{this.updateSlice(e)}),this.render()},imageViewSliceUpdated(){q["W"].value&&(be.value.forEach(e=>{const{imageMapper:t}=e;["X","L"].includes(q["W"].value)?t.setISlice(q["eb"].value.x):["Y","P"].includes(q["W"].value)?t.setJSlice(q["eb"].value.y):["Z","S"].includes(q["W"].value)&&t.setKSlice(q["eb"].value.z),q["Z"].value&&this.updateCuttingPlane(e)}),this.render())},imageViewWindowUpdated(){be.value.forEach(({sliceActor:e})=>{e.getProperty().setColorWindow(q["fb"].value)}),this.render()},imageViewLevelUpdated(){be.value.forEach(({sliceActor:e})=>{e.getProperty().setColorLevel(q["ab"].value)}),this.render()},imageViewIntersectModeUpdated(){be.value.forEach(e=>{this.updateIntersection(e),this.updateCuttingPlane(e)}),this.render()},watchImageStates(){Object(n["watch"])(q["cb"],this.imageViewModeUpdated),Object(n["watch"])(q["W"],this.imageViewAxisUpdated),Object(n["watch"])(q["eb"],this.imageViewSliceUpdated,{deep:!0}),Object(n["watch"])(q["fb"],this.imageViewWindowUpdated),Object(n["watch"])(q["ab"],this.imageViewLevelUpdated),Object(n["watch"])(q["Z"],this.imageViewIntersectModeUpdated),Object(n["watch"])(q["Y"],this.imageViewIntersectModeUpdated)},resetImageSlices(){be.value=[]},resetIntersections(){be.value.forEach(this.updateIntersection)}};const me=[[0,255,0],[255,0,0]],ge=[[166,206,227],[31,120,180],[178,223,138],[51,160,44],[251,154,153],[227,26,28],[253,191,111],[255,127,0],[202,178,214],[106,61,154],[255,255,153],[177,89,40]];var he={...le,...fe,async resize(){await this.$nextTick(),this.vtk.renderWindow&&this.updateSize()},updateSize(){const e=this.$refs.vtk;if(e){const{width:t,height:a}=e.getBoundingClientRect();this.vtk.openglRenderWindow.setSize(t,a),this.render()}},newOrientationCube(e){return F["a"].newInstance({actor:q["yb"].value,interactor:e,viewportSize:.1,minPixelSize:100,maxPixelSize:300,viewportCorner:F["a"].Corners.TOP_RIGHT})},initializeCameras(){this.initialCameraStates={position:{},viewUp:{}},Object.values(this.vtk.renderers).forEach((e,t)=>{const a=e.getActiveCamera();this.initialCameraStates.position["renderer_"+t]=[...a.getReferenceByName("position")],this.initialCameraStates.viewUp["renderer_"+t]=[...a.getReferenceByName("viewUp")]})},getCameraDelta(e){if(!e)return{positionDelta:void 0,viewUpDelta:void 0};const t=e.getActiveCamera(),a=Object.values(this.vtk.renderers).indexOf(e);if(a>=0){const e="renderer_"+a;this.initialCameraPosition=this.initialCameraStates.position[e],this.initialCameraViewUp=this.initialCameraStates.viewUp[e],this.newCameraPosition=t.getReferenceByName("position"),this.newCameraViewUp=t.getReferenceByName("viewUp")}const n=[...this.newCameraPosition].map((e,t)=>e-this.initialCameraPosition[t]),i=[...this.newCameraViewUp].map((e,t)=>e-this.initialCameraViewUp[t]);return{positionDelta:n,viewUpDelta:i}},applyCameraDelta(e,t,a){const n=e.getActiveCamera(),i=Object.values(this.vtk.renderers).indexOf(e),r="renderer_"+i;this.initialCameraStates.position[r]&&(n.setPosition(...this.initialCameraStates.position[r].map((e,a)=>e+t[a])),n.setViewUp(...this.initialCameraStates.viewUp[r].map((e,t)=>e+a[t]))),e.resetCameraClippingRange()},syncCameras(e){const t=e.pokedRenderer,{positionDelta:a,viewUpDelta:n}=this.getCameraDelta(t);Object.values(this.vtk.renderers).filter(e=>e!==t).forEach(e=>{this.applyCameraDelta(e,a,n)})},createColorFilter(e=0,t=!1){const a=K["a"].newInstance();return a.setFormula({getArrays(){return{input:[{location:G["b"].COORDINATE}],output:[{location:G["b"].POINT,name:"color",dataType:"Uint8Array",attribute:B["a"].SCALARS,numberOfComponents:3}]}},evaluate(a,n){const[i]=a.map(e=>e.getData()),[r]=n.map(e=>e.getData()),s=i.length/3;for(let o=0;o<s;o+=1){var l;let a=ge[o%ge.length];t&&null!==(l=q["m"].value)&&void 0!==l&&l.length&&(a=q["S"].value[e][o]<q["T"].value?me[0]:me[1]),a&&(r[3*o]=a[0],r[3*o+1]=a[1],r[3*o+2]=a[2])}a.forEach(e=>e.modified())}}),a},addPoints(e,t,a){let n=this.glyphSize,i=L["a"].newInstance({thetaResolution:J["d"],phiResolution:J["d"]});const r=U["a"].newInstance({scaleMode:U["a"].SCALE_BY_CONSTANT,scaleFactor:n}),s=z["a"].newInstance(),l=this.createColorFilter(a,q["Ob"].value);l.setInputData(t,0),r.setInputConnection(l.getOutputPort(),0),r.setInputConnection(i.getOutputPort(),1),s.setMapper(r),e.addActor(s),this.vtk.pointMappers.push(r)},addShapes(e,t){let a;Object.entries(this.vtk.renderers).forEach(([t,n])=>{e==n&&(a=t)}),t.forEach((t,n)=>{t.forEach(t=>{var i;let r=Object.entries(q["Vb"].value).filter(([,e])=>e.includes(t)).map(([e])=>e);r=r.length?r[0]:"Original";const s=q["mb"].value.find(e=>e.name===r);let l=1;if(null===(i=q["m"].value)||void 0===i||!i.length){const e=q["nb"].value.filter(e=>q["mb"].value.find(t=>t.name==e).rgb).length;e>0&&(l/=e)}const o=`${a}_${r}_${n}`,c=I["a"].newInstance({colorMode:$["a"].MAP_SCALARS,scalarMode:$["b"].USE_POINT_FIELD_DATA});if("vtkImageData"==t.getClassName()&&"Original - Image"===r)this.addImage(t,e);else{if("vtkPolyData"==t.getClassName())c.setInputData(t);else if(q["q"].value[o])c.setInputData(q["q"].value[o]);else{const e=R["a"].newInstance({contourValue:.001,computeNormals:!0,mergePoints:!0});e.setInputData(t),c.setInputConnection(e.getOutputPort()),q["q"].value[o]=e.getOutputData()}if(q["Nb"].value&&this.showDifferenceFromMean(c,e,a,n),[1,2].includes(q["F"].value)){let e;if(t.getPointData().getArrayByName("deepssm_error")&&(e=t.getPointData().getArrayByName("deepssm_error").getData()),e){let a;a=q["Tb"].value?q["G"].value:[Math.min(...e),Math.max(...e)];const n=e.map(e=>e/(a[1]-a[0])),i=N["a"].newInstance({name:"deepssm_error_normalized",values:n});t.getPointData().addArray(i),c.setColorByArrayName("deepssm_error_normalized"),c.setLookupTable(this.lookupTable)}}const i=z["a"].newInstance();s&&i.getProperty().setColor(...s.rgb),i.getProperty().setOpacity(l),i.setMapper(c),e.addActor(i)}})})},showDifferenceFromMean(e,t,a,n){if(!q["m"].value||!q["z"].value||!q["wb"].value||!this.metaData[a]||!this.metaData[a][n])return;const i=this.metaData[a][n],r=i.current.points.getPoints().getData(),s=i.mean.points.getPoints().getData(),l=q["z"].value[n];let o,c;if(l in q["r"].value&&l in q["s"].value)o=q["r"].value[l],c=q["s"].value[l];else{const t=Object(q["t"])(e,r,s);o=t.colorValues,c=t.vectorValues,Object(q["p"])(o,c,l)}if(c){const e=U["a"].newInstance({colorMode:$["a"].MAP_SCALARS,scalarMode:$["b"].USE_POINT_FIELD_DATA}),a=z["a"].newInstance(),n=A["a"].newInstance(),i=W["a"].newInstance(),r=new Uint32Array(c.length+1);r[0]=c.length;for(let t=0;t<c.length;t++)r[t+1]=t;let s=[],l=[],o=[];for(let t=0;t<c.length;t++){const[e,a,n,i,r,u,d]=c[t];if(i<0){const t=3;s.push([e+r*t,a+u*t,n+d*t]),l.push([-r,-u,-d]),o.push(i/10+.5)}else i>0&&(s.push([e+r,a+u,n+d]),l.push([r,u,d]),o.push(i/10+.5))}n.getPointData().addArray(N["a"].newInstance({name:"color",values:o})),n.getPointData().addArray(N["a"].newInstance({name:"normal",values:l.flat(),numberOfComponents:3})),n.getPoints().setData(s.flat(),3),n.getVerts().setData(r),a.setMapper(e),e.setInputData(n),e.addInputConnection(i.getOutputPort(),1),e.setScaleFactor(5),e.setColorByArrayName("color"),e.setOrientationArray("normal"),e.setLookupTable(this.lookupTable),t.addActor(a)}const u=N["a"].newInstance({name:"color",values:o});e.getInputData().getPointData().addArray(u),e.getInputData().modified(),e.setLookupTable(this.lookupTable),e.setColorByArrayName("color"),q["Nb"].value&&(this.lookupTable.setMappingRange(0,1),this.lookupTable.updateRange(),this.prepareColorScales()),this.render()},prepareColorScales(){const e=this.$refs.colors,t=this.$refs.colorsTitle,a=this.$refs.colorsLabels;if(e.innerHTML="",t.innerHTML="",a.innerHTML="",q["Nb"].value||q["Tb"].value){const n=document.createElement("canvas");n.style.right="10px",n.style.height="100%",n.style.width="20px",e.appendChild(n);const i=document.createElement("div");i.style.right="35px",i.style.height="100%",a.appendChild(i);let r=[-5,5];q["Nb"].value?t.innerHTML="Distance from particle on mean shape":q["Tb"].value&&(t.innerHTML="DeepSSMError",r=q["G"].value),this.prepareColorScale(n,i,r)}else Object.entries(this.data).forEach(([,t],n)=>{if(t[0].shape.filter(e=>"vtkPolyData"===e.getClassName()&&!e.getPointData().getArrayByName("deepssm_error")).length>0)return;const[,i,r,s]=this.grid[n],l=document.createElement("canvas");l.style.top=`calc(${100*(1-s)}%)`,l.style.right=`calc(${100*(1-r)}% + 10px)`,l.style.height=96*(s-i)+"%",l.style.width="10px",e.appendChild(l);const o=document.createElement("div");o.style.top=`calc(${100*(1-s)}%)`,o.style.right=`calc(${100*(1-r)}% + 35px)`,o.style.height=96*(s-i)+"%",a.appendChild(o);let c=[-5,5];t[0].shape.forEach(e=>{if("vtkPolyData"===e.getClassName()){const t=e.getPointData().getArrayByName("deepssm_error").getData();t&&(c=[Math.min(...t),Math.max(...t)])}}),this.prepareColorScale(l,o,c)})},prepareColorScale(e,t,a){if(e&&t){e.style.position="absolute",e.style.zIndex="1";const{width:n,height:i}=e,r=e.getContext("2d",{willReadFrequently:!0}),s=r.getImageData(0,0,n,i),l=this.lookupTable.getUint8Table(...this.lookupTable.getMappingRange(),i*n,!0);s.data.set(l),r.putImageData(s,0,0);const o=[1,.75,.5,.25,0];t.innerHTML="",t.style.position="absolute",t.style.display="flex",t.style.flexDirection="column",t.style.justifyContent="space-between",t.style.alignItems="flex-end",t.style.textAlign="right",o.forEach(e=>{const n=document.createElement("span");n.innerHTML=Math.round(e*(a[1]-a[0])+a[0]),t.appendChild(n)})}},prepareLabelCanvas(){const e=this.$refs.labels,t=e.getContext("2d"),{clientWidth:a,clientHeight:n}=this.$refs.vtk;e.width=a,e.height=n,t.clearRect(0,0,e.width,e.height),t.font="16px Arial",t.fillStyle="white"},populateRenderer(e,t){this.addShapes(e,t.map(({shape:e})=>e)),t.map(({points:e})=>e).forEach((t,a)=>{t.getNumberOfPoints()>0&&this.addPoints(e,t,a)});const a=V["a"].newInstance();e.setActiveCamera(a),e.resetCamera()},renderGrid(){let e,t;this.vtk.interactor.disable(),Object.values(this.vtk.widgetManagers).forEach(e=>{e.disablePicking()}),this.resetImageSlices(),this.prepareLabelCanvas();const a=Object.values(this.vtk.renderers);for(let i=0;i<a.length;i+=1)e&&t||({positionDelta:e,viewUpDelta:t}=this.getCameraDelta(Object.values(this.vtk.renderers)[0])),this.vtk.renderWindow.removeRenderer(a[i]);this.vtk.orientationCube&&this.vtk.orientationCube.setEnabled(!1),this.vtk.renderers={},this.vtk.pointMappers=[];const n=Object.entries(this.data);for(let i=0;i<n.length;i+=1){const[e,t]=n[i],a=T["a"].newInstance({background:[.115,.115,.115]}),r=this.grid[i],s=this.$refs.labels,l=s.getContext("2d");l.fillText(e,s.width*r[0],s.height*(1-r[1])-20),a.setViewport.apply(a,r),this.vtk.renderers[e]=a,this.vtk.renderWindow.addRenderer(a),i<n.length&&this.populateRenderer(a,t)}if(this.initializeCameras(),this.initializeWidgets(),e&&t&&Object.values(this.vtk.renderers).forEach(a=>{this.applyCameraDelta(a,e,t)}),q["Z"].value?this.resetIntersections():[1,2].includes(q["F"].value)&&this.prepareColorScales(),!this.showColorScale){const e=Object.values(this.vtk.renderers)[this.columns-1];e&&(this.vtk.orientationCube.setParentRenderer(e),this.vtk.orientationCube.setEnabled(!0))}this.vtk.interactor.enable(),this.render(),q["Fb"].value=!1,setTimeout(()=>{Object.values(this.vtk.widgetManagers).forEach(e=>{e.enablePicking()})},100)},render(){this.vtk.renderWindow.render()}},_e={props:{data:{type:Object,required:!0},metaData:{type:Object,required:!1},rows:{type:Number,required:!0},columns:{type:Number,required:!0},glyphSize:{type:Number,required:!0},currentTab:{type:String,required:!0},drawerWidth:{type:Number,required:!1}},computed:{grid(){const e=[],t=this.columns,a=this.rows;for(let n=0;n<a;n+=1)for(let i=0;i<t;i+=1){const r=i/t,s=n/a,l=(i+1)/t,o=(n+1)/a;e.push([r,1-o,l,1-s])}return e},showDifferenceFromMeanMode(){return q["Nb"].value},deepSSMDataTab(){return q["F"].value},showColorScale(){return q["Nb"].value||q["F"].value>=0}},watch:{data(){this.renderGrid()},grid(){this.renderGrid()},glyphSize(){this.updateGlyphSize(this.glyphSize),this.vtk.pointMappers.forEach(e=>{e.setScaleFactor(this.glyphSize)}),this.render()},drawerWidth(){this.updateSize()}},beforeDestroy(){this.vtk.interactor.unbindEvents(),this.vtk.orientationCube.delete(),this.vtk.openglRenderWindow.setContainer(null)},created(){const e=P["a"].newInstance(),t=k["a"].newInstance();e.addView(t);const a=C["a"].newInstance();a.setView(t),a.initialize(),a.setInteractorStyle(D["a"].newInstance()),a.onAnimation(this.syncCameras),a.disable();const n=this.newOrientationCube(a);this.lookupTable=E["a"].newInstance(),this.lookupTable.applyColorMap(M["a"].getPresetByName("erdc_rainbow_bright")),this.lookupTable.setMappingRange(0,1),this.lookupTable.updateRange(),this.vtk={renderWindow:e,interactor:a,openglRenderWindow:t,orientationCube:n,renderers:{},pointMappers:[],widgetManagers:{}},q["Ub"].value=this.vtk},mounted(){const e=this.$refs.vtk;this.vtk.openglRenderWindow.setContainer(e),this.vtk.interactor.bindEvents(e),this.updateSize(),this.renderGrid(),this.watchWidgetStates(),this.watchImageStates()},updated(){this.showColorScale&&this.prepareColorScale()},methods:he},ye=_e,je=(a("2cbc"),a("2877")),Oe=Object(je["a"])(ye,S,x,!1,null,"3e171041",null),we=Oe.exports,Se=a("ac7c"),xe=a("8fea"),De=a("8860"),ke=a("56b0"),Pe=a("1baa"),Ce=a("e0c7"),Ee=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"100%"}},[t(De["a"],{attrs:{dense:"",shaped:""}},[t(Ce["a"],[e._v("ANATOMIES")]),t(Pe["a"],e._l(e.anatomies.filter(t=>t!==e.allDataObjectsInDataset[0].modality),(function(a){return t(l["a"],{key:a},[t(Se["a"],{attrs:{color:"primary",value:a},model:{value:e.selectedAnatomies,callback:function(t){e.selectedAnatomies=t},expression:"selectedAnatomies"}}),t(o["c"],[e._v(" "+e._s(a)+" ")])],1)})),1),t(Ce["a"],[e._v("SUBJECTS")]),t(Pe["a"],e._l(e.allSubjectsForDataset,(function(a){return t(ke["a"],{key:a.id,scopedSlots:e._u([{key:"activator",fn:function(){return[t(Se["a"],{attrs:{color:"primary",value:a.id},nativeOn:{click:function(e){return e.stopPropagation()}},model:{value:e.selectedSubjects,callback:function(t){e.selectedSubjects=t},expression:"selectedSubjects"}}),t(f["a"],{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function({on:n,attrs:i}){return[t(o["c"],e._g(e._b({},"v-list-item-title",i,!1),n),[e._v(" Subject: "+e._s(a.name)+" ")])]}}],null,!0)},[t("span",[e._v(" ID: "+e._s(a.id)+" | Created: "+e._s(e.shortDateString(a.created))+" | Modified: "+e._s(e.shortDateString(a.modified))+" ")])])]},proxy:!0}],null,!0),model:{value:a.showDetails,callback:function(t){e.$set(a,"showDetails",t)},expression:"subject.showDetails"}},[a.groups&&Object.keys(a.groups).length>0?t("div",{staticClass:"pa-3"},[e._v(" Subject Groups "+e._s(JSON.stringify(a.groups).replace(/"/g,"").replace(/:/g,": ").replace(/,/g,", "))+" ")]):e._e(),t(xe["a"],{attrs:{headers:e.headers,items:e.allDataObjectsInDataset.filter(e=>e.subject===a.id),"item-key":"uid","disable-pagination":"","hide-default-footer":"",dense:"",width:"100%"},scopedSlots:e._u([{key:"item.file",fn:function({item:a}){return[t("span",[e._v(e._s(e.shortFileName(a.file)))])]}}],null,!0)})],1)})),1)],1)],1)},Me=[],Ie=a("c31b"),Ae={props:{dataset:{type:Number,required:!0},autoSelectAll:{type:Boolean,default:!1},autoSelectOne:{type:Boolean,default:!1}},setup(e){const t=Object(n["ref"])([]),a=[{text:"ID",value:"id"},{text:"Anatomy",value:"anatomy_type"},{text:"Type",value:"type"},{text:"File Name",value:"file",cellClass:"file-column"}];async function i(a){if(q["vb"].value=!0,q["i"].value=(await Object(Ie["u"])(a)).sort((e,t)=>e.created<t.created?1:e.created>t.created?-1:0),q["d"].value=(await Promise.all(q["i"].value.map(async e=>(await Object(Ie["h"])(e.id)).map(e=>{let t={uid:`${e.type}_${e.id}`};return Object.assign(e,t)})))).flat(),Object(q["ub"])("",0),q["n"].value=Object.keys({...Object(O["c"])(q["d"].value,"anatomy_type"),...Object(O["c"])(q["d"].value,"modality")}).filter(e=>"undefined"!==e),q["Hb"].value=q["n"].value,q["i"].value.length>0){const a=q["i"].value.map(e=>e.id);e.autoSelectAll&&(t.value=a),e.autoSelectOne&&q["i"].value.length>0&&(t.value=[a[0]])}q["vb"].value=!1}function r(){q["Ib"].value=q["d"].value.filter(e=>(!q["Hb"].value.length||q["Hb"].value.includes(e.anatomy_type)||q["Hb"].value.includes(e.modality))&&t.value.includes(e.subject))}function s(){const e=[...new Set(q["Ib"].value.map(e=>e.modality&&q["cb"].value?e.modality:e.anatomy_type))].filter(e=>void 0!==e),a=[...new Set(q["Ib"].value.map(e=>e.subject))];JSON.stringify(e)!==JSON.stringify(q["Hb"].value)&&(q["Hb"].value=e),JSON.stringify(a)!==JSON.stringify(t.value)&&(t.value=a)}return Object(n["onMounted"])(async()=>{q["Jb"].value?await i(q["Jb"].value.id):await i(e.dataset)}),Object(n["watch"])(q["Hb"],r),Object(n["watch"])(t,r),Object(n["watch"])(q["Ib"],s),{anatomies:q["n"],selectedAnatomies:q["Hb"],allSubjectsForDataset:q["i"],selectedSubjects:t,headers:a,allDataObjectsInDataset:q["d"],selectedDataObjects:q["Ib"],shortFileName:O["h"],shortDateString:O["g"]}}},Te=Ae,Le=(a("edc1"),Object(je["a"])(Te,Ee,Me,!1,null,null,null)),Re=Le.exports,Fe=a("8336"),We=a("cc20"),Ne=a("b974"),ze=a("ba0d"),Ke=a("b73d"),Ve=a("8654"),Ue=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"render-control-row"},[e.showAnalysisOptions?e._e():t(Ne["a"],{staticStyle:{width:"500px"},attrs:{items:e.layers,"item-disabled":e=>!e.available(),"item-value":"name",label:"Layers shown",multiple:"","small-chips":"","item-text":"name"},scopedSlots:e._u([{key:"selection",fn:function({item:a}){return[t(We["a"],{attrs:{close:"",color:a.color,"text-color":"white"===a.color?"black":"white"},on:{"click:close":function(t){e.layersShown=e.layersShown.filter(e=>e!==a.name)}}},[e._v(" "+e._s(a.name)+" ")])]}}],null,!1,97843889),model:{value:e.layersShown,callback:function(t){e.layersShown=t},expression:"layersShown"}}),t(Ve["a"],{staticStyle:{width:"80px"},attrs:{label:"Particle Size",type:"number",step:"0.5",min:"0.5",max:"10","hide-details":""},model:{value:e.particleSize,callback:function(t){e.particleSize=e._n(t)},expression:"particleSize"}}),t(Ne["a"],{staticStyle:{width:"100px"},attrs:{value:e.axisSystem,items:e.axisSystemOptions,label:"Axis System"},on:{change:e.changeAxisSystem}}),e.layersShown.includes("Original")?t(Ke["a"],{attrs:{value:e.imageViewMode,label:"Image View"},on:{change:e.changeImageViewMode}}):e._e(),e.showAnalysisOptions&&"analyze"===e.currentTab?t(Ke["a"],{attrs:{label:"Show difference from mean"},model:{value:e.showDifferenceFromMeanMode,callback:function(t){e.showDifferenceFromMeanMode=t},expression:"showDifferenceFromMeanMode"}}):e._e(),e.showSamplePageSelector?t(Ve["a"],{attrs:{value:e.deepSSMSamplePage,label:"Sample Page",min:"0",step:"1",type:"number"},on:{input:e.onChangeSamplePage}}):e._e(),e.showUniformScaleOption?t(Ke["a"],{attrs:{label:"Uniform Scale"},model:{value:e.uniformScale,callback:function(t){e.uniformScale=t},expression:"uniformScale"}}):e._e(),e.showAnalysisOptions||1!==e.selectedDataObjects.length?e._e():t(Fe["a"],{staticClass:"my-5",on:{click:e.captureThumbnail}},[e._v(" Set "+e._s(e.thumbnailTarget.type)+" thumbnail ")]),t(Fe["a"],{staticClass:"my-5",on:{click:e.resetView}},[e._v(" Reset view ")])],1),e.imageViewMode&&e.axisSystem?t("div",{staticClass:"render-control-row"},[e.imageIntersectAllowed?t("div",[t(Se["a"],{staticClass:"mt-0 pt-0",attrs:{label:"Intersect",dense:!0,"hide-details":!0},model:{value:e.imageViewIntersectMode,callback:function(t){e.imageViewIntersectMode=t},expression:"imageViewIntersectMode"}}),t(Se["a"],{attrs:{label:"Crop",dense:!0,"hide-details":!0},model:{value:e.imageViewIntersectCropMode,callback:function(t){e.imageViewIntersectCropMode=t},expression:"imageViewIntersectCropMode"}})],1):e._e(),t(Ne["a"],{staticStyle:{width:"25%"},attrs:{items:e.axisSystem.axes,label:"Axis","hide-details":!0},model:{value:e.imageViewAxis,callback:function(t){e.imageViewAxis=t},expression:"imageViewAxis"}}),e.imageViewSliceRange?t(ze["a"],{staticStyle:{width:"25%"},attrs:{value:e.imageViewSlice,min:e.imageViewSliceRange[0],max:e.imageViewSliceRange[1],"thumb-label":!0,label:"Slice","hide-details":!0},on:{input:e.changeImageViewSlice}}):e._e(),t(ze["a"],{staticStyle:{width:"25%"},attrs:{min:e.imageViewWindowRange[0],max:e.imageViewWindowRange[1],"thumb-label":!0,label:"Window","hide-details":!0},model:{value:e.imageViewWindow,callback:function(t){e.imageViewWindow=t},expression:"imageViewWindow"}}),t(ze["a"],{staticStyle:{width:"25%"},attrs:{min:e.imageViewLevelRange[0],max:e.imageViewLevelRange[1],"thumb-label":!0,label:"Level","hide-details":!0},model:{value:e.imageViewLevel,callback:function(t){e.imageViewLevel=t},expression:"imageViewLevel"}})],1):e._e()])},Be=[],$e={props:{currentTab:{type:String,required:!0}},setup(e,t){q["yb"].value.setDefaultStyle({fontStyle:"bold",fontFamily:"Arial",fontColor:"black",faceColor:"#ffffff",faceRotation:0,edgeThickness:.1,edgeColor:"black",resolution:400});const a=[{text:"XYZ",value:"xyz",xPlus:"+X",xMinus:"-X",yPlus:"+Y",yMinus:"-Y",zPlus:"+Z",zMinus:"-Z",axes:["X","Y","Z"]},{text:"Medical",value:"slp",xPlus:"L",xMinus:"R",yPlus:"P",yMinus:"A",zPlus:"S",zMinus:"I",axes:["L","P","S"]}],i=Object(n["ref"])();function r(e){if(q["cb"].value=e,e)q["Hb"].value=[...q["Hb"].value,"anatomy_mri"];else{const e=q["d"].value[0].modality;q["Hb"].value=q["Hb"].value.filter(t=>t!==e)}}function s(e){const n=a.find(t=>t.value==e);i.value=n,n&&(q["yb"].value.setXPlusFaceProperty({text:n.xPlus}),q["yb"].value.setXMinusFaceProperty({text:n.xMinus}),q["yb"].value.setYPlusFaceProperty({text:n.yPlus}),q["yb"].value.setYMinusFaceProperty({text:n.yMinus}),q["yb"].value.setZPlusFaceProperty({text:n.zPlus}),q["yb"].value.setZMinusFaceProperty({text:n.zMinus}),t.emit("change"))}function l(){t.emit("change")}s("xyz"),Object(n["watch"])(q["Nb"],l),Object(n["watch"])(q["Ob"],l),Object(n["watch"])(q["T"],l);const o=Object(n["computed"])(()=>{var e,t;return 1===q["nb"].value.length&&"Original"===q["nb"].value[0]?{type:"Dataset",id:null===(e=q["Jb"].value)||void 0===e?void 0:e.id}:{type:"Project",id:null===(t=q["Kb"].value)||void 0===t?void 0:t.id}});async function c(){if(q["Ub"].value){q["Ub"].value.orientationCube.setEnabled(!1);const e=(await Promise.all(q["Ub"].value.renderWindow.captureImages("image/png",{size:[100,100]})))[0],t=e.split(",")[1];if("Dataset"===o.value.type){if(o.value.id){let e=await Object(Ie["B"])(o.value.id,t);e&&(q["e"].value=q["e"].value.map(t=>t.id===e.id?e:t),q["Jb"].value=e)}}else if(o.value.id){let e=await Object(Ie["C"])(o.value.id,t);e&&(q["f"].value=q["f"].value.map(t=>t.id===e.id?e:t),q["Kb"].value=e)}q["Ub"].value.orientationCube.setEnabled(!0)}}const u=Object(n["computed"])(()=>{var t;return!("deepssm"!==e.currentTab||!q["I"].value)||!("analyze"!==e.currentTab||null===(t=q["m"].value)||void 0===t||!t.length)}),d=Object(n["computed"])(()=>0===q["F"].value&&q["J"].value),v=Object(n["computed"])(()=>{var e;return Math.ceil(Object.values(null===(e=q["I"].value)||void 0===e?void 0:e.aug_pairs).length/q["a"])}),p=Object(n["computed"])(()=>q["F"].value>=1),b=Object(n["computed"])(()=>q["nb"].value.includes("Groomed")||q["F"].value>-1),f=Object(n["computed"])(()=>{if(q["W"].value)return["X","L"].includes(q["W"].value)?q["eb"].value.x:["Y","P"].includes(q["W"].value)?q["eb"].value.y:["Z","S"].includes(q["W"].value)?q["eb"].value.z:void 0}),m=Object(n["computed"])(()=>{if(q["W"].value)return["X","L"].includes(q["W"].value)?q["Y"].value?q["X"].value.x:q["db"].value.x:["Y","P"].includes(q["W"].value)?q["Y"].value?q["X"].value.y:q["db"].value.y:["Z","S"].includes(q["W"].value)?q["Y"].value?q["X"].value.z:q["db"].value.z:void 0});function g(e){q["W"].value&&(["X","L"].includes(q["W"].value)?q["eb"].value.x=e:["Y","P"].includes(q["W"].value)?q["eb"].value.y=e:["Z","S"].includes(q["W"].value)&&(q["eb"].value.z=e))}function h(e){e<1?e=1:e>v.value&&(e=v.value),q["J"].value=e}return Object(n["watch"])(b,e=>{e||(q["Z"].value=!1,q["Y"].value=!1)}),{particleSize:q["zb"],layersShown:q["nb"],layers:q["mb"],axisSystem:i,axisSystemOptions:a,imageViewMode:q["cb"],imageViewIntersectMode:q["Z"],imageViewIntersectCropMode:q["Y"],imageIntersectAllowed:b,imageViewAxis:q["W"],imageViewSlice:f,imageViewSliceRange:m,imageViewLevel:q["ab"],imageViewLevelRange:q["bb"],imageViewWindow:q["fb"],imageViewWindowRange:q["gb"],changeImageViewSlice:g,changeAxisSystem:s,changeImageViewMode:r,resetView:l,selectedDataObjects:q["Ib"],captureThumbnail:c,thumbnailTarget:o,showDifferenceFromMeanMode:q["Nb"],showAnalysisOptions:u,showUniformScaleOption:p,uniformScale:q["Tb"],deepSSMSamplePage:q["J"],onChangeSamplePage:_.a.debounce(h,1e3),showSamplePageSelector:d,maxSamplePage:v,currentTab:e.currentTab}}},Ge=$e,qe=(a("7d6ca"),Object(je["a"])(Ge,Ue,Be,!1,null,"359b5e24",null)),Je=qe.exports,He=a("4bd4"),Ze=function(){var e=this,t=e._self._c;return t("div",[e.props.prerequisite()?t("div",[t("task-info",{attrs:{taskName:e.props.form,formData:e.simplifyFormData(e.formData)},on:{resetForm:e.resetForm}}),t(He["a"],{staticClass:"pa-3",model:{value:e.formValid,callback:function(t){e.formValid=t},expression:"formValid"}},[e.formSchema&&e.formData?t("v-jsf",{attrs:{schema:e.formSchema,options:e.schemaOptions},scopedSlots:e._u([{key:"custom-conditional",fn:function(a){return[e.evaluateExpression(a.schema["x-display-if"])?t("v-jsf",e._b({scopedSlots:e._u([{key:"custom-readonly",fn:function(a){return[t("div",{staticStyle:{display:"flex",width:"100%","justify-content":"space-between"}},[t("p",[e._v(e._s(a.label))]),t("p",[e._v(e._s(a.value)+e._s(a.schema["x-display-append"]))])])]}}],null,!0),model:{value:e.formData[a.fullKey.split(".")[0]][a.fullKey.split(".")[1]],callback:function(t){e.$set(e.formData[a.fullKey.split(".")[0]],a.fullKey.split(".")[1],t)},expression:"formData[context.fullKey.split('.')[0]][context.fullKey.split('.')[1]]"}},"v-jsf",a,!1)):e._e()]}}],null,!1,1776082980),model:{value:e.formData,callback:function(t){e.formData=t},expression:"formData"}}):e._e(),t("br")],1)],1):t("div",{staticClass:"pa-3",staticStyle:{"text-align":"center"}},[e._v(e._s(e.props.prerequisite_unfulfilled))])])},Ye=[],Xe=a("ce26"),Qe=Xe["a"],et=(a("8998"),Object(je["a"])(Qe,Ze,Ye,!1,null,null,null)),tt=et.exports,at=a("169a"),nt=a("cd55"),it=a("49e2"),rt=a("c865"),st=a("0393"),lt=function(){var e=this,t=e._self._c;return e.jobAlreadyDone("optimize")?t("div",[t(st["a"],{attrs:{value:e.analysis?1:0}},[t(nt["a"],[t(rt["a"],[e._v("Controls")]),t(it["a"],[t("task-info",{attrs:{taskName:"analyze",formData:e.formData,disabled:!e.analysis},on:{resetForm:e.resetForm}}),t(Ve["a"],{attrs:{type:"number",step:"1.0",max:"10.0",min:"1.0",label:"Std. Dev. Range","hide-details":"",disabled:!e.analysis},model:{value:e.formData.range,callback:function(t){e.$set(e.formData,"range",e._n(t))},expression:"formData.range"}}),t(Ve["a"],{attrs:{type:"number",step:"1.0",min:"1.0",max:"100.0",label:"Number of steps","hide-details":"",disabled:!e.analysis},model:{value:e.formData.steps,callback:function(t){e.$set(e.formData,"steps",e._n(t))},expression:"formData.steps"}})],1)],1),e.analysis?t(nt["a"],[t(rt["a"],[e._v("Results")]),t(it["a"],[t("div",{staticClass:"pa-3"},[e._v(" Review shape analysis "),t(f["a"],{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function({on:a,attrs:n}){return[t(s["a"],e._g(e._b({},"v-icon",n,!1),a),[e._v(" mdi-information ")])]}}],null,!1,3439555294)},[t("span",[t(Ce["a"],[e._v("Last analysis run at "+e._s(e.analysis.modified))])],1)]),t(st["a"],{model:{value:e.openTab,callback:function(t){e.openTab=t},expression:"openTab"}},[t(nt["a"],[t(rt["a"],[e._v(" View PCA ")]),t(it["a"],[t("PCA",{ref:"pca",attrs:{currentTab:e.currentTab,openTab:e.openTab}}),t("charts",{attrs:{charts:e.analysis.charts}})],1)],1),t(nt["a"],{attrs:{disabled:e.analysis.groups.length<=0,id:"groups-panel"}},[t(rt["a"],[e._v(" Group Difference ")]),t(it["a"],[t("groups",{ref:"groups",attrs:{currentTab:e.currentTab,openTab:e.openTab}})],1)],1),t(nt["a"],[t(rt["a"],[e._v(" Particles ")]),t(it["a"],[t("particles")],1)],1)],1),t("div",{staticClass:"loading-dialog"},[t(at["a"],{attrs:{width:"10%"},model:{value:e.currentlyCaching,callback:function(t){e.currentlyCaching=t},expression:"currentlyCaching"}},[e._v("Calculating... "),t(d["a"],{attrs:{indeterminate:"","align-center":""}})],1)],1)],1)])],1):e._e()],1)],1):t("div",{staticClass:"pa-3",staticStyle:{"text-align":"center"}},[e._v("Perform optimization before analyzing.")])},ot=[],ct=function(){var e=this,t=e._self._c;return e.charts.length>0?t("div",e._l(e.charts,(function(a,n){return t("v-chart",{key:a.title,staticClass:"chart",attrs:{option:e.methods.generateChart(n)}})})),1):t("div",[e._v(" No charts generated... ")])},ut=[],dt=a("22b4"),vt=a("97ac"),pt=a("3620"),bt=a("9394"),ft=a("2da7"),mt=a("4b2a"),gt=a("3094"),ht=a("104d"),_t=a("5c7f");a("88a7"),a("271a"),a("5494"),a("5b81");function yt(e){const t=3;return e.y.forEach((a,n)=>{e.y[n]=xt(a,t)}),{title:{text:e.title,textStyle:{color:"#999999"}},dataZoom:[{id:"xAxisZoom",type:"inside",xAxisIndex:[0]}],tooltip:{trigger:"axis",formatter:"# Modes: {b}<br />Value: {c}"},toolbox:{show:!0,orient:"horizontal",showTitle:!0,feature:{saveAsImage:{type:"svg",name:e.title.toLowerCase()+"_chart",excludedComponents:["toolbox","title"]},dataView:{show:!0,title:"View Data",readOnly:!0,optionToContent:()=>St(e)},dataZoom:{show:!0},restore:{show:!0}}},xAxis:{type:"category",name:e.x_label,nameLocation:"center",nameTextStyle:{padding:[5,0,0,0],color:"#bbbbbb"},axisLabel:{align:"center",color:"#a3a3a3"},boundaryGap:!1,splitLine:{show:!0,lineStyle:{type:"dashed",opacity:.5}},data:e.x},yAxis:{name:e.y_label,nameTextStyle:{align:"left",color:"#bbbbbb"},axisLine:{show:!0},axisLabel:{align:"right",color:"#a3a3a3"},axisTick:{lineStyle:{color:"#a3a3a3"}},scale:!0,splitLine:{show:!0,lineStyle:{type:"dashed",opacity:.5}}},series:{type:"line",data:e.y}}}function jt(e){const t=wt(e);navigator.clipboard.writeText(t).then((function(){console.log("Copying to clipboard was successful!")}),(function(e){console.error("Could not copy data: ",e)}))}function Ot(e){const t=wt(e),a=t.split(/\n/g).map((e,t)=>t?e+"\n":e),n=new Blob(a);return URL.createObjectURL(n)}function wt(e){const t=e.split("\n");return t.forEach((e,a)=>{if(e.search(/\s/gi)>=0){const n=e.split(",");n.forEach((e,t)=>{n[t]='"'+e+'"'}),t[a]=n.join(",")}}),t.join("\n")}function St(e){const t=document.createElement("TABLE");t.className="datatable";const a=document.createElement("thead");t.appendChild(a);const n=a.insertRow(0);n.className="datatable-row";const i=n.insertCell(0);i.innerHTML="<b># Modes</b>";const r=n.insertCell(1);r.innerHTML=`<b>${e.y_label}</b>`;const s=document.createElement("tbody");t.appendChild(s);let l=`# Modes:,${e.y_label}\n`;for(let v=0;v<e.x.length;v++){const t=s.insertRow(-1);t.className="datatable-row";const a=t.insertCell(0);a.innerHTML=""+e.x[v];const n=t.insertCell(1);n.innerHTML=""+e.y[v],l+=`${e.x[v]},${e.y[v]}\n`}const o=document.createElement("div");o.className="dataview";const c=document.createElement("button");c.className="dataview-button copy-button",c.innerHTML="Copy to Clipboard",c.onclick=()=>jt(l);const u=document.createElement("button");u.className="dataview-button download-button",u.innerHTML="Download";const d=document.createElement("a");return d.href=Ot(l),d.download=e.y_label.toLowerCase().replaceAll(" ","_")+".csv",u.appendChild(d),u.onclick=()=>d.click(),o.appendChild(t),o.appendChild(c),o.appendChild(u),o}function xt(e,t){const a=10**t;return Math.round(e*a)/a}Object(dt["a"])([vt["a"],pt["a"],bt["a"],ft["a"],mt["a"],gt["a"],ht["a"]]);var Dt,kt={name:"Charts",props:{charts:{type:Array,default:()=>[],validator:e=>e.every(e=>"object"===typeof e&&null!==e&&"string"===typeof e.title&&"string"===typeof e.type&&"string"===typeof e.x_label&&"string"===typeof e.y_label&&e.x.every(e=>"number"===typeof e)&&e.y.every(e=>"number"===typeof e)),required:!0}},components:{VChart:_t["a"]},setup(e){const t={},a={generateChart:t=>yt(e.charts[t])},n={},i=()=>{};return i(),{data:t,methods:a,computed:n}}},Pt=kt,Ct=(a("3ea8"),Object(je["a"])(Pt,ct,ut,!1,null,null,null)),Et=Ct.exports,Mt=a("a609"),It=a("62ad"),At=a("ce7e"),Tt=a("0fd9"),Lt=function(){var e=this,t=e._self._c;return t("div",[t(Ne["a"],{attrs:{label:"Group Set",items:e.allGroupSets,"item-text":"set","item-value":"set"},model:{value:e.groupSet,callback:function(t){e.groupSet=t},expression:"groupSet"}}),t(At["a"]),t(Tt["a"],{attrs:{align:"center",justify:"center"}},[t(It["a"],[t(Ne["a"],{attrs:{items:e.currGroup&&e.groupSet?e.groupPairings[e.groupSet]:[""],"item-text":"group1","item-value":"group1"},model:{value:e.currPairing.left,callback:function(t){e.$set(e.currPairing,"left",t)},expression:"currPairing.left"}})],1),t(It["a"],[t(ze["a"],{attrs:{min:"0.0",max:"1.0",step:"0.1",default:"0.5","show-ticks":"always","hide-details":"",disabled:void 0===e.currGroup},model:{value:e.groupRatio,callback:function(t){e.groupRatio=t},expression:"groupRatio"}})],1),t(It["a"],[t(Ne["a"],{attrs:{items:e.currGroup&&e.groupSet?e.groupPairings[e.groupSet]:[""],"item-text":"group2","item-value":"group2"},model:{value:e.currPairing.right,callback:function(t){e.$set(e.currPairing,"right",t)},expression:"currPairing.right"}})],1)],1),t(Tt["a"],{attrs:{justify:"center"}},[t(Se["a"],{staticClass:"mt-0 mb-8 pt-0",attrs:{disabled:void 0===e.currGroup,label:"Animate","hide-details":""},model:{value:e.animate,callback:function(t){e.animate=t},expression:"animate"}})],1),t(r["a"],{staticClass:"ma-auto mb-3",attrs:{align:"center",justify:"center",disabled:void 0===e.currGroup}},[t(Fe["a"],{staticClass:"ms-4",attrs:{color:"grey darken-3"},on:{click:()=>{e.groupRatio=0,e.methods.stopAnimating()}}},[e._v("Left Mean")]),t(Mt["a"],{staticClass:"ms-4",attrs:{color:"white"}},[t(Fe["a"],{attrs:{color:"grey darken-4",disabled:e.animate||e.currentlyCaching},on:{click:()=>e.groupDiff=!e.groupDiff}},[e._v("Diff --\x3e")])],1),t(Fe["a"],{staticClass:"ms-4",attrs:{color:"grey darken-3"},on:{click:()=>{e.groupRatio=1,e.methods.stopAnimating()}}},[e._v("Right Mean")])],1)],1)},Rt=[];(function(e){e[e["PCA"]=0]="PCA",e[e["Groups"]=1]="Groups",e[e["Charts"]=2]="Charts",e[e["Particles"]=3]="Particles"})(Dt||(Dt={}));var Ft={props:{currentTab:String,openTab:Number},setup(e){const t=Object(n["ref"])(),a=Object(n["ref"])(.5),i=Object(n["ref"])(!1),r=Object(n["ref"])(),s=Object(n["ref"])({left:"",right:""}),l=Object(n["ref"])({left:"",right:""}),o=Object(n["inject"])("currentlyCaching"),c=Object(n["ref"])(!1);let u,d=.1;const v={pairingIsInverted(e){return e.group1===s.value.right&&e.group2===s.value.left},updateCurrGroup(){var e;t.value=null===(e=q["j"].value)||void 0===e?void 0:e.groups.filter(e=>{if(e.name===r.value&&(e.group1===s.value.left&&e.group2===s.value.right||e.group1===s.value.right&&e.group2===s.value.left))if(v.pairingIsInverted(e)){if(v.pairingIsInverted(e)&&e.ratio===parseFloat((1-a.value).toFixed(1)))return!0}else if(e.ratio===a.value)return!0})},setDefaultPairing(){var e;void 0===r.value&&null!==(e=p.value)&&void 0!==e&&e.length&&(r.value=p.value[0]),void 0!==r.value&&(s.value.left=b.value[r.value][0],s.value.right=b.value[r.value][1],l.value={left:s.value.left,right:s.value.right})},updateGroupSelections(){s.value.left===s.value.right&&void 0!==r.value&&(s.value.left===l.value.left&&(s.value.left=l.value.right),s.value.right===l.value.right&&(s.value.right=l.value.left)),l.value.left=s.value.left,l.value.right=s.value.right,v.updateGroupFileShown()},updateGroupFileShown(){let a=void 0,n=void 0;if(v.updateCurrGroup(),"analyze"===e.currentTab&&q["j"].value&&t.value&&(a=t.value.map(e=>e.file),n=t.value.map(e=>e.particles)),q["z"].value=n,i.value){var s;const e=null===(s=q["j"].value)||void 0===s?void 0:s.groups.filter(e=>{if(e.name===r.value)if(v.pairingIsInverted(e)){if(v.pairingIsInverted(e)&&0===e.ratio)return!0}else if(1===e.ratio)return!0});e&&(q["wb"].value=e.map(e=>e.particles))}else{var l;q["wb"].value=null===(l=q["j"].value)||void 0===l?void 0:l.mean_shapes.map(e=>e.particles)}q["m"].value=a},async cacheAllGroupComparisons(){var e;const t=null===(e=q["j"].value)||void 0===e?void 0:e.groups.filter(e=>{if(e.name===r.value&&(e.group1===s.value.left||e.group1===s.value.right)&&(e.group2===s.value.left||e.group2===s.value.right))return!0});void 0!==t&&await Object(q["o"])([t])},animateSlider(){e.openTab===Dt.Groups&&(0===a.value&&(d=.1),1===a.value&&(d=-.1),a.value=parseFloat((a.value+d).toFixed(1)))},async triggerAnimate(){void 0!==r.value&&void 0!=c&&(c.value&&o&&(o.value=!0,await v.cacheAllGroupComparisons(),o.value=!1,u=setInterval(v.animateSlider,500)),!1===c.value&&u&&clearInterval(u))},stopAnimating(){c.value=!1}},p=Object(n["computed"])(()=>{var e;return null===(e=q["j"].value)||void 0===e?void 0:e.groups.map(e=>e.name)}),b=Object(n["computed"])(()=>{var e;const t={};return null===(e=q["j"].value)||void 0===e||e.groups.map(e=>{void 0===t[e.name]&&(t[e.name]=[]),t[e.name].includes(e.group1)||t[e.name].push(e.group1),t[e.name].includes(e.group2)||t[e.name].push(e.group2)}),t});return Object(n["onMounted"])(v.setDefaultPairing),Object(n["watch"])(r,()=>{v.setDefaultPairing(),v.updateGroupFileShown(),v.stopAnimating()}),Object(n["watch"])(s.value,()=>{v.updateGroupSelections(),v.stopAnimating()}),Object(n["watch"])(a,v.updateGroupFileShown),Object(n["watch"])(i,v.updateGroupFileShown),c&&Object(n["watch"])(c,v.triggerAnimate),{methods:v,groupRatio:a,groupDiff:i,groupSet:r,allGroupSets:p,groupPairings:b,currGroup:t,currPairing:s,animate:c,currentlyCaching:o}}},Wt=Ft,Nt=Object(je["a"])(Wt,Lt,Rt,!1,null,null,null),zt=Nt.exports,Kt=function(){var e=this,t=e._self._c;return t("div",{attrs:{disabled:"!goodBadAngles.value"}},[t(Tt["a"],{attrs:{justify:"center"}},[t(Ke["a"],{staticClass:"mt-0 mb-8 pt-0",attrs:{label:"Show Good/Bad Particles","hide-details":""},model:{value:e.showGoodBadParticlesMode,callback:function(t){e.showGoodBadParticlesMode=t},expression:"showGoodBadParticlesMode"}})],1),t(Ve["a"],{attrs:{value:e.goodBadMaxAngle,type:"number",step:"1.0",min:"1.0",max:"360.0",label:"Max Angle","hide-details":""},on:{input:e.changeMaxAngle}})],1)},Vt=[],Ut={name:"Particles",setup(){function e(e){parseFloat(e)&&(q["T"].value=parseFloat(e))}return{changeMaxAngle:_.a.debounce(e,1e3),showGoodBadParticlesMode:q["Ob"],goodBadAngles:q["S"],goodBadMaxAngle:q["T"]}}},Bt=Ut,$t=Object(je["a"])(Bt,Kt,Vt,!1,null,null,null),Gt=$t.exports,qt=function(){var e=this,t=e._self._c;return t("div",[t(Ne["a"],{attrs:{label:"Select mode",items:e.modeOptions,"item-text":"mode","item-value":"mode"},model:{value:e.mode,callback:function(t){e.mode=t},expression:"mode"}}),t(Tt["a"],{attrs:{justify:"space-between"}},[t(ze["a"],{attrs:{min:-1*e.stdDevRange.range,max:e.stdDevRange.range,step:e.stdDevRange.step,ticks:"always","tick-size":"4","thumb-label":"","track-color":"#aaa","track-fill-color":"#aaa",label:"Std. Devs. from Mean"},scopedSlots:e._u([{key:"thumb-label",fn:function(){return[e._v(" "+e._s(Math.round(100*e.stdDev)/100)+" ")]},proxy:!0}]),model:{value:e.stdDev,callback:function(t){e.stdDev=t},expression:"stdDev"}})],1),t(Tt["a"],{attrs:{justify:"center"}},[t(Se["a"],{staticClass:"mt-0 mb-8 pt-0",attrs:{label:"Animate","hide-details":""},model:{value:e.animate,callback:function(t){e.animate=t},expression:"animate"}})],1),t("br"),t(xe["a"],{attrs:{headers:e.pcaInfo.headers,items:e.pcaInfo.items,"item-class":"class","hide-default-header":"","hide-default-footer":""}})],1)},Jt=[],Ht={props:{currentTab:String,openTab:Number},setup(e){const t=Object(n["ref"])(1),a=Object(n["ref"])(0),i=Object(n["ref"])(),r=Object(n["ref"])(!1);let s,l=0;const o=Object(n["inject"])("currentlyCaching"),c=Object(n["ref"])(!1),u=Object(n["computed"])(()=>{var e;return null===(e=q["j"].value)||void 0===e?void 0:e.modes.sort((e,t)=>e.mode-t.mode)}),d=Object(n["computed"])(()=>{var e;return null===(e=q["j"].value)||void 0===e?void 0:e.modes.find(e=>e.mode==t.value)}),v=Object(n["computed"])(()=>{var e;return null===(e=d.value)||void 0===e?void 0:e.pca_values.filter(e=>e.pca_value.toPrecision(2)===a.value.toPrecision(2))}),p=Object(n["computed"])(()=>{if(!q["j"].value||!d.value)return{range:0,step:0,numSteps:0};const e=d.value.pca_values.map(e=>Math.round(100*e.pca_value)/100),t=q["j"].value.mean_shapes.length||1,a=Math.min(...e),n=Math.max(...e),i=n,r=(n-a)/(e.length/t),s=Math.round((n-a)/r)+1;return{range:i,step:r,numSteps:s}}),b=Object(n["computed"])(()=>{var e;return{headers:[{text:"key",value:"key"},{text:"value",value:"value",align:"end"}],items:[{key:"Lambda",value:null!==(e=v.value)&&void 0!==e&&e.length?Math.round(100*v.value[0].lambda_value)/100:0},{key:"Eigenvalue",value:d.value?Math.round(100*d.value.eigen_value)/100:0},{key:"Explained Variance",value:d.value?Math.round(100*d.value.explained_variance)/100:0,class:"percentage"},{key:"Cumulative Explained Variance",value:d.value?Math.round(100*d.value.cumulative_explained_variance)/100:0,class:"percentage"}]}}),f={updateFileShown(){var t;let n=[],i=[];"analyze"===e.currentTab&&q["j"].value&&(0===a.value?(n=q["j"].value.mean_shapes.map(e=>e.file),i=q["j"].value.mean_shapes.map(e=>e.particles)):v.value&&(n=v.value.map(e=>e.file),i=v.value.map(e=>e.particles))),q["z"].value=i,q["wb"].value=null===(t=q["j"].value)||void 0===t?void 0:t.mean_shapes.map(e=>e.particles),q["m"].value=n},async cacheAllPCAComparisons(){if(void 0!==d.value){const e=Object.values(Object(O["c"])(d.value.pca_values,"pca_value"));await Object(q["o"])(e)}},animateSlider(){if(e.openTab===Dt.PCA){const{range:e}=p.value,t=-1*e,n=e;a.value<=t?(a.value=t,l*=-1):a.value>=n&&(a.value=n,l*=-1),a.value=parseFloat((a.value+l).toFixed(1))}},async triggerAnimate(){void 0!==d.value&&void 0!==c&&(c.value&&o&&(l=p.value.step,o.value=!0,await f.cacheAllPCAComparisons(),o.value=!1,s=setInterval(f.animateSlider,500)),!1===c.value&&s&&clearInterval(s))},stopAnimating(){c.value=!1}},m=()=>{f.updateFileShown()};return m(),Object(n["watch"])(e,f.updateFileShown),Object(n["watch"])(q["j"],f.updateFileShown),Object(n["watch"])(t,()=>{f.updateFileShown(),c.value=!1}),Object(n["watch"])(a,f.updateFileShown),c&&Object(n["watch"])(c,f.triggerAnimate),{methods:f,modeOptions:u,mode:t,stdDev:a,stdDevRange:p,pcaInfo:b,animate:c,menu:i,showConfirmation:r,selectedProject:q["Kb"]}}},Zt=Ht,Yt=(a("b13f"),Object(je["a"])(Zt,qt,Jt,!1,null,null,null)),Xt=Yt.exports,Qt=a("a314"),ea={props:{currentTab:{type:String,required:!0}},components:{Charts:Et,Groups:zt,Particles:Gt,PCA:Xt,TaskInfo:Qt["a"]},setup(){const e={range:2,steps:11},t=Object(n["ref"])(Dt.PCA),a=Object(n["ref"])({...e}),i=Object(n["ref"])(!1),r=Object(n["ref"])(),s=Object(n["ref"])();function l(){a.value=e}return Object(n["provide"])("currentlyCaching",i),Object(n["watch"])(t,()=>{switch(q["l"].value=t.value,t.value){case Dt.PCA:s.value&&s.value.methods.stopAnimating(),r.value.methods.updateFileShown();break;case Dt.Groups:r.value.methods.stopAnimating(),s.value&&s.value.currGroup&&s.value.methods.updateGroupFileShown();break;case Dt.Charts:s.value&&s.value.methods.stopAnimating(),r.value.methods.stopAnimating();break;case Dt.Particles:s.value&&s.value.methods.stopAnimating(),r.value.methods.stopAnimating();break}}),{analysis:q["j"],formData:a,openTab:t,currentlyCaching:i,pca:r,groups:s,resetForm:l,jobAlreadyDone:q["hb"]}}},ta=ea,aa=(a("a038"),Object(je["a"])(ta,lt,ot,!1,null,null,null)),na=aa.exports,ia=function(){var e=this,t=e._self._c;return t(st["a"],{model:{value:e.openPanel,callback:function(t){e.openPanel=t},expression:"openPanel"}},[t("landmarks"),t("constraints")],1)},ra=[],sa=a("99d9"),la=a("03a4"),oa=a("8e36"),ca=a("2fa4"),ua=function(){var e=this,t=e._self._c;return t(nt["a"],[t(rt["a"],[e._v(" Landmarks "),t(ca["a"]),t(Ve["a"],{staticStyle:{"max-width":"50px"},attrs:{label:"Size",type:"number",min:"1",max:"15"},on:{click:function(e){e.stopPropagation()}},model:{value:e.landmarkSize,callback:function(t){e.landmarkSize=e._n(t)},expression:"landmarkSize"}})],1),e.landmarksLoading?t(it["a"],[t(oa["a"],{attrs:{indeterminate:""}})],1):t(it["a"],[t(xe["a"],{attrs:{headers:e.headers,items:e.landmarkInfo,expanded:e.expandedRows,"item-key":"id","disable-pagination":"","hide-default-footer":"","single-select":"",dense:"",width:"100%"},scopedSlots:e._u([{key:"item.color",fn:function({index:a,item:n}){return[t(at["a"],{attrs:{value:"index",width:"400"},scopedSlots:e._u([{key:"activator",fn:function({on:a,attrs:n}){return[t(s["a"],e._g(e._b({staticClass:"delete-icon"},"v-icon",n,!1),a),[e._v(" mdi-trash-can ")])]}}],null,!0),model:{value:e.dialogs[a],callback:function(t){e.$set(e.dialogs,a,t)},expression:"dialogs[index]"}},[t(r["a"],[t(sa["c"],{staticStyle:{"word-break":"break-word"}},[e._v(" Are you sure you want to remove "+e._s(n.name)+" on all subjects? ")]),t(sa["a"],[t(ca["a"]),t(Fe["a"],{attrs:{color:"red"},on:{click:function(t){return e.deleteLandmark(n)}}},[e._v(" Yes, Delete This Landmark ")])],1)],1)],1),t(at["a"],{attrs:{width:"300"},scopedSlots:e._u([{key:"activator",fn:function({on:n,attrs:i}){return[t(Fe["a"],e._g(e._b({staticClass:"color-square",style:{backgroundColor:e.colorStrings[a]}},"v-btn",i,!1),n))]}}],null,!0)},[t(r["a"],[t(sa["c"],[e._v("Change color for "+e._s(n.name))]),t(la["a"],{attrs:{value:e.getColorObject(n.color),"dot-size":"25"},on:{"update:color":t=>e.updateLandmarkColor(a,t)}})],1)],1)]}},{key:"item.name",fn:function({index:a,item:n}){return[t(Ve["a"],{staticStyle:{width:"100px"},on:{input:t=>e.updateLandmarkInfo(a,t,n.comment)},model:{value:n.name,callback:function(t){e.$set(n,"name",t)},expression:"item.name"}})]}},{key:"item.comment",fn:function({index:a,item:n}){return[t(Ve["a"],{staticStyle:{width:"130px"},on:{input:t=>e.updateLandmarkInfo(a,n.name,t)},model:{value:n.comment,callback:function(t){e.$set(n,"comment",t)},expression:"item.comment"}})]}},{key:"item.domain",fn:function({index:a,item:n}){return[t(Ne["a"],{staticStyle:{width:"80px"},attrs:{items:e.anatomies.map(e=>e.replace("anatomy_","")),disabled:n.num_set>0},on:{input:t=>e.updateLandmarks()},model:{value:n.domain,callback:function(t){e.$set(n,"domain",t)},expression:"item.domain"}})]}},{key:"item.num_set",fn:function({item:a}){return[t("div",{staticStyle:{width:"60px","text-align":"right"}},[e._v(" "+e._s(a.num_set)+" / "+e._s(e.allSubjectsForDataset.length)+" "),e.expandedRows.includes(a)?t(s["a"],{on:{click:function(t){e.expandedRows=[]}}},[e._v("mdi-menu-up")]):t(s["a"],{on:{click:function(t){e.expandedRows=[a]}}},[e._v("mdi-menu-down")])],1)]}},{key:"expanded-item",fn:function({item:a}){return[t("div",{staticStyle:{width:"100%"}},e._l(e.allSubjectsForDataset,(function(n){return t("div",{key:n.id,staticClass:"d-flex py-1",staticStyle:{"align-items":"center","justify-content":"space-between",width:"100%"}},[t("span",{staticStyle:{width:"170px"}},[e._v(e._s(n.name))]),t(Fe["a"],{attrs:{small:""},on:{click:function(t){return e.toggleSubjectShown(n.id,a.domain)}}},[e._v(" "+e._s(e.isShapeShown(n.id,a.domain)?"Hide":"Show")+" subject ")]),e.getPlacementStatus(n,a)?t("div",{staticStyle:{width:"170px","text-align":"right"}},[!e.currentLandmarkPlacement&&"NOT SET"===e.getPlacementStatus(n,a)&&e.isShapeShown(n.id,a.domain)?t(Fe["a"],{attrs:{small:""},on:{click:function(t){return e.beginPlacement(n,a)}}},[e._v(" BEGIN PLACEMENT ")]):t("span",[e._v(" "+e._s(e.getPlacementStatus(n,a))+" ")])],1):e._e()],1)})),0)]}}])}),t("div",{staticClass:"d-flex py-3",staticStyle:{"justify-content":"space-between"}},[t(Fe["a"],{on:{click:e.newLandmark}},[e._v(" + New Landmark ")]),e.changesMade?t(Fe["a"],{attrs:{color:"primary"},on:{click:e.submit}},[e._v(" Save Landmarks ")]):t("span",[e._v("Landmarks Saved.")])],1)],1)],1)},da=[],va=a("4597"),pa={setup(){const e=[{text:"",value:"color",width:"60px",sortable:!1},{text:"Name",value:"name",width:"120px"},{text:"Comment",value:"comment",width:"150px"},{text:"Domain",value:"domain",width:"100px"},{text:"# set",value:"num_set",width:"60px",sortable:!1}],t=Object(n["ref"])(!1),a=Object(n["ref"])([]),i=Object(n["ref"])([]),r=Object(n["computed"])(()=>q["jb"].value.map(({color:e})=>`rgb(${e[0]},${e[1]},${e[2]})`));function s(e){return{r:e[0],g:e[1],b:e[2]}}function l(e,t){const a=Object(va["i"])(e,t);if(a){if(q["C"].value===Object(va["k"])(e,t))return`Click anywhere on ${e.name} ${t.domain}`;const n=[];return a.forEach(e=>n.push(e.toFixed(2))),n.join(", ")}return"NOT SET"}function o(e,t){q["C"].value=Object(va["k"])(e,t)}function c(){var e,n;const i=(null===(e=q["jb"].value)||void 0===e?void 0:e.length)||0,r={color:[i%2*100,i%5*50,i%3*80],comment:"",domain:q["n"].value[0].replace("anatomy_",""),id:i,name:"L"+i,num_set:0,visible:!0};null!==(n=q["jb"].value)&&void 0!==n&&n.length?q["jb"].value=[...q["jb"].value,r]:q["jb"].value=[r],Object(q["Cb"])(),a.value=[r],q["Kb"].value.landmarks=[...q["Kb"].value.landmarks,{newAddition:!0}],t.value=!0}function u(e){q["i"].value.forEach(t=>{Object(va["z"])(t,e,void 0)}),q["jb"].value.splice(e.id,1),Object(q["Cb"])(),q["C"].value=void 0,i.value=[],a.value=[],t.value=!0}function d(e,a,n){q["jb"].value[e]=Object.assign({},q["jb"].value[e],{name:a,comment:n}),q["jb"].value=[...q["jb"].value],t.value=!0}function v(e,t){t=[t.rgba.r,t.rgba.g,t.rgba.b],q["jb"].value[e]=Object.assign({},q["jb"].value[e],{color:t}),q["jb"].value=[...q["jb"].value]}function p(){q["jb"].value=[...q["jb"].value]}function b(){const e=Object.fromEntries(Object.entries(q["h"].value).map(([e,t])=>{var a;const n=null===(a=q["i"].value.find(t=>t.name===e))||void 0===a?void 0:a.id;return[n,Object.fromEntries(Object.entries(t).map(([e,t])=>[e,Object.values(t).filter(e=>e)]))]})),a=q["jb"].value.map(e=>({domain:e.domain,name:e.name,visible:"true",color:Object(O["f"])(e.color),comment:e.comment}));Object(Ie["A"])(q["Kb"].value.id,a,e).then(e=>{e.id===q["Kb"].value.id&&(q["Kb"].value=e,t.value=!1)})}return Object(n["watch"])(q["h"],()=>t.value=!0),Object(n["watch"])(q["C"],e=>{Object(q["Db"])(),e||(t.value=!0)}),{headers:e,changesMade:t,dialogs:i,landmarksLoading:q["lb"],expandedRows:a,colorStrings:r,landmarkSize:q["kb"],landmarkInfo:q["jb"],anatomies:q["n"],allSubjectsForDataset:q["i"],currentLandmarkPlacement:q["C"],isShapeShown:va["l"],toggleSubjectShown:va["C"],getColorObject:s,getPlacementStatus:l,beginPlacement:o,newLandmark:c,deleteLandmark:u,updateLandmarkColor:v,updateLandmarkInfo:d,updateLandmarks:p,submit:b}}},ba=pa,fa=(a("15e2"),Object(je["a"])(ba,ua,da,!1,null,null,null)),ma=fa.exports,ga=function(){var e=this,t=e._self._c;return t(nt["a"],[t(rt["a"],[e._v(" Constraints "),t(ca["a"])],1),e.constraintsLoading?t(it["a"],[t(oa["a"],{attrs:{indeterminate:""}})],1):t(it["a"],[t(xe["a"],{staticClass:"contraints-table",attrs:{headers:e.headers,items:e.constraintInfo,expanded:e.expandedRows,"item-key":"id","disable-pagination":"","hide-default-footer":"","single-select":"",dense:"",width:"100%"},scopedSlots:e._u([{key:"item.id",fn:function({index:a,item:n}){return[t(at["a"],{attrs:{value:"index",width:"400"},scopedSlots:e._u([{key:"activator",fn:function({on:a,attrs:n}){return[t(s["a"],e._g(e._b({staticClass:"delete-icon"},"v-icon",n,!1),a),[e._v(" mdi-trash-can ")])]}}],null,!0),model:{value:e.dialogs[a],callback:function(t){e.$set(e.dialogs,a,t)},expression:"dialogs[index]"}},[t(r["a"],[t(sa["c"],{staticStyle:{"word-break":"break-word"}},[e._v(" Are you sure you want to remove "+e._s(n.name)+" on all subjects? ")]),t(sa["a"],[t(ca["a"]),t(Fe["a"],{attrs:{color:"red"},on:{click:function(t){return e.deleteConstraint(n)}}},[e._v(" Yes, Delete This Constraint ")])],1)],1)],1)]}},{key:"item.show",fn:function({index:a,item:n}){return[t(s["a"],{on:{click:function(t){return e.toggleConstraintShown(n)}}},[e._v(" "+e._s(e.constraintsShown.includes(n.id)?"mdi-eye-outline":"mdi-eye-off-outline")+" ")])]}},{key:"item.name",fn:function({index:a,item:n}){return[t(Ve["a"],{staticStyle:{width:"130px"},on:{input:function(t){e.changesMade=!0}},model:{value:n.name,callback:function(t){e.$set(n,"name",t)},expression:"item.name"}})]}},{key:"item.type",fn:function({index:a,item:n}){return[t(Ne["a"],{staticStyle:{width:"100px"},attrs:{items:["plane","paint"],disabled:n.num_set>0,"error-messages":e.constraintErrors[n.id]},on:{change:t=>e.validateConstraint(n)},model:{value:n.type,callback:function(t){e.$set(n,"type",t)},expression:"item.type"}})]}},{key:"item.domain",fn:function({index:a,item:n}){return[t(Ne["a"],{staticStyle:{width:"80px"},attrs:{items:e.anatomies.map(e=>e.replace("anatomy_","")),disabled:n.num_set>0},on:{change:t=>e.validateConstraint(n)},model:{value:n.domain,callback:function(t){e.$set(n,"domain",t)},expression:"item.domain"}})]}},{key:"item.num_set",fn:function({item:a}){return[t("div",{staticStyle:{width:"60px","text-align":"right"}},[e._v(" "+e._s(a.num_set)+" / "+e._s(e.allSubjectsForDataset.length)+" "),e.expandedRows.includes(a)?t(s["a"],{on:{click:function(t){e.expandedRows=[]}}},[e._v("mdi-menu-up")]):t(s["a"],{on:{click:function(t){e.expandedRows=[a]}}},[e._v("mdi-menu-down")])],1)]}},{key:"expanded-item",fn:function({item:a}){return[t("div",{staticStyle:{width:"calc(100% - 20px)"}},e._l(e.allSubjectsForDataset,(function(n){return t("div",{key:n.id,staticClass:"d-flex py-1",staticStyle:{"align-items":"center","justify-content":"space-between",width:"100%"}},[t("span",{staticStyle:{width:"150px"}},[e._v(e._s(n.name))]),e.currentConstraintPlacement?"PLACING"===e.getPlacementStatus(n,a)&&"paint"===a.type?t("div",{staticStyle:{width:"200px","text-align":"center"}},[t(Ve["a"],{staticStyle:{"max-width":"70px",display:"inline-block","margin-right":"10px"},attrs:{label:"Brush Size",type:"number",min:"1",max:"15"},on:{click:function(e){e.stopPropagation()}},model:{value:e.constraintPaintRadius,callback:function(t){e.constraintPaintRadius=e._n(t)},expression:"constraintPaintRadius"}}),t(f["a"],{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function({on:a,attrs:n}){return[t("div",e._g(e._b({staticStyle:{"max-width":"70px",display:"inline-block","margin-right":"10px"}},"div",n,!1),a),[t(Ke["a"],{attrs:{label:"Exclude"},model:{value:e.constraintPaintExclusion,callback:function(t){e.constraintPaintExclusion=t},expression:"constraintPaintExclusion"}})],1)]}}],null,!0)},[t("span",[e._v("Enable to paint exclusion area. Disable to erase exclusion area.")])])],1):t(ca["a"]):t(Fe["a"],{attrs:{small:""},on:{click:function(t){return e.toggleSubjectShown(n.id,a.domain)}}},[e._v(" "+e._s(e.isShapeShown(n.id,a.domain)?"Hide":"Show")+" subject ")]),t("div",{staticStyle:{width:"140px","text-align":"right"}},["INVALID"===e.getPlacementStatus(n,a)?t("span",[e._v(" INVALID ")]):e.isShapeShown(n.id,a.domain)&&!e.constraintsShown.includes(a.id)?t("span",[e._v(" Not visible ")]):e.isShapeShown(n.id,a.domain)&&"plane placed"!==e.getPlacementStatus(n,a)?t(Fe["a"],{attrs:{small:""},on:{click:function(t){return e.toggleCurrentPlacement(n,a)}}},["NOT SET"===e.getPlacementStatus(n,a)?t("span",[e._v("BEGIN PLACEMENT")]):e._e(),"PLACING"===e.getPlacementStatus(n,a)?t("span",[e._v("DONE")]):e._e(),"paint placed"===e.getPlacementStatus(n,a)?t("span",[e._v("EDIT PAINT")]):e._e()]):t("span",[e._v(" "+e._s(e.getPlacementStatus(n,a)))])],1)],1)})),0)]}}])}),t("div",{staticClass:"d-flex py-3",staticStyle:{"justify-content":"space-between"}},[t(Fe["a"],{on:{click:e.newConstraint}},[e._v(" + New Constraint ")]),e.changesMade?t(Fe["a"],{attrs:{color:"primary"},on:{click:e.submit}},[e._v(" Save Constraints ")]):t("span",[e._v("Constraints Saved.")])],1),!e.changesMade&&e.saveWarning?t("span",{staticStyle:{color:"orange"}},[e._v(" "+e._s(e.saveWarning)+" ")]):e._e()],1)],1)},ha=[],_a=a("db11"),ya={setup(){const e=[{text:"",value:"id",width:"10px",sortable:!1},{text:"Show",value:"show",width:"10px",sortable:!1},{text:"Name",value:"name",width:"150px"},{text:"Type",value:"type",width:"120px"},{text:"Domain",value:"domain",width:"100px"},{text:"# set",value:"num_set",width:"60px",sortable:!1,align:"end"}],t=Object(n["ref"])(!1),a=Object(n["ref"])([]),i=Object(n["ref"])([]),r=Object(n["ref"])({}),s=Object(n["ref"])();function l(e,t){const a=Object(va["g"])(e,t);return JSON.stringify(q["A"].value)===JSON.stringify(Object(va["k"])(e,t))?"PLACING":a?t.type+" placed":r.value[t.id]?"INVALID":"NOT SET"}function o(e){q["y"].value.includes(e.id)?q["y"].value=q["y"].value.filter(t=>t!==e.id):q["y"].value=[...q["y"].value,e.id]}function c(e,t){q["A"].value?q["A"].value=void 0:q["A"].value=Object(va["k"])(e,t)}function u(e){"paint"===e.type&&q["u"].value.some(t=>t.id!==e.id&&t.domain===e.domain&&t.type===e.type)?r.value[e.id]="Only one paint constraint can exist per domain. Edit the existing paint constraint.":r.value[e.id]=void 0}function d(){var e,n;const i=(null===(e=q["u"].value)||void 0===e?void 0:e.length)||0,r={type:"plane",domain:q["n"].value[0].replace("anatomy_",""),id:i,num_set:0,visible:!0};null!==(n=q["u"].value)&&void 0!==n&&n.length?q["u"].value=[...q["u"].value,r]:q["u"].value=[r],Object(q["Bb"])(),a.value=[r],o(r),q["Kb"].value.constraints=[...q["Kb"].value.constraints,{newAddition:!0}],t.value=!0}function v(e){o(e),q["i"].value.forEach(t=>{Object(va["y"])(t,e,void 0)}),q["u"].value.splice(e.id,1),Object(q["Bb"])(),q["A"].value=void 0,i.value=[],a.value=[],t.value=!0}function p(){const e=Object.fromEntries(q["i"].value.map(e=>[e.id,Object.fromEntries(Object.entries(Object(O["c"])(q["u"].value,"domain")).map(([t,a])=>{let n=[];q["g"].value[e.name]&&q["g"].value[e.name][t]&&(n=Object.values(q["g"].value[e.name][t]));const i=Object(_a["a"])(n,a);return[t,i]}))])),a=q["u"].value.filter(e=>0===e.num_set);if(a.length>0){const e=a.length>1,t=a.map(e=>e.name||e.id);s.value=`Constraint${e?"s":""}\n                    ${t.join(", ")}\n                    ${e?"do":"does"}\n                    not have any placements and will not be saved.`}Object(Ie["z"])(q["Kb"].value.id,e).then(e=>{e.id===q["Kb"].value.id&&(q["Kb"].value=e,t.value=!1)})}return Object(n["watch"])(q["g"],()=>{t.value=!0,s.value=void 0},{deep:!0}),{headers:e,changesMade:t,dialogs:i,constraintsLoading:q["x"],constraintErrors:r,saveWarning:s,expandedRows:a,constraintInfo:q["u"],constraintsShown:q["y"],anatomies:q["n"],allSubjectsForDataset:q["i"],constraintPaintRadius:q["w"],constraintPaintExclusion:q["v"],currentConstraintPlacement:q["A"],isShapeShown:va["l"],toggleSubjectShown:va["C"],getPlacementStatus:l,validateConstraint:u,toggleConstraintShown:o,toggleCurrentPlacement:c,newConstraint:d,deleteConstraint:v,submit:p}}},ja=ya,Oa=(a("6634"),Object(je["a"])(ja,ga,ha,!1,null,null,null)),wa=Oa.exports,Sa={components:{Landmarks:ma,Constraints:wa},setup(){const e=Object(n["ref"])(0);function t(){q["nb"].value=q["mb"].value.filter(t=>"Landmarks"===t.name?0===e.value:"Constraints"===t.name?1===e.value:q["nb"].value.includes(t.name)).map(e=>e.name)}return Object(n["watch"])(e,t),Object(n["onMounted"])(t),{openPanel:e}}},xa=Sa,Da=Object(je["a"])(xa,ia,ra,!1,null,null,null),ka=Da.exports,Pa=a("adda"),Ca=a("24c9"),Ea=a("67b6"),Ma=a("43a6"),Ia=a("aac8"),Aa=function(){var e,t,a,n,i=this,r=i._self._c;return r("div",{staticClass:"pa-3"},[r("task-info",{attrs:{taskName:"deepssm",formData:i.formData},on:{resetForm:i.resetForm}}),r("div",{staticClass:"loading-dialog"},[r(at["a"],{attrs:{width:"10%"},model:{value:i.deepSSMLoadingData,callback:function(e){i.deepSSMLoadingData=e},expression:"deepSSMLoadingData"}},[i._v("Fetching results... "),r(d["a"],{attrs:{indeterminate:"","align-center":""}})],1)],1),r(st["a"],{model:{value:i.openExpansionPanel,callback:function(e){i.openExpansionPanel=e},expression:"openExpansionPanel"}},[i.selectedProject&&!i.selectedProject.readonly?r(nt["a"],[r(rt["a"],[i._v("Controls")]),r(it["a"],[r(b["a"],{model:{value:i.controlsTabs,callback:function(e){i.controlsTabs=e},expression:"controlsTabs"}},[r(v["a"],[i._v("Prep")]),r(v["a"],[i._v("Augmentation")]),r(v["a"],[i._v("Training")])],1),r(Ia["a"],{model:{value:i.controlsTabs,callback:function(e){i.controlsTabs=e},expression:"controlsTabs"}},[r(p["a"],[r("div",[r(Ve["a"],{attrs:{type:"number",label:"Test Split",suffix:"%"},model:{value:i.prepData.testing_split.value,callback:function(e){i.$set(i.prepData.testing_split,"value",i._n(e))},expression:"prepData.testing_split.value"}}),r(Ve["a"],{attrs:{type:"number",label:"Validation Split",suffix:"%"},model:{value:i.prepData.validation_split.value,callback:function(e){i.$set(i.prepData.validation_split,"value",i._n(e))},expression:"prepData.validation_split.value"}}),r(Ve["a"],{attrs:{type:"number",label:"Percent Variablity Preserved",min:"0.0",max:"100.0",suffix:"%"},model:{value:i.prepData.percent_variability.value,callback:function(e){i.$set(i.prepData.percent_variability,"value",i._n(e))},expression:"prepData.percent_variability.value"}}),r("div",{staticClass:"image-spacing"},[r(Ca["a"],{staticClass:"spacing-label"},[i._v("Image Spacing")]),r(Ve["a"],{staticClass:"spacing-input",attrs:{type:"number",label:"X"},model:{value:i.prepData.image_spacing.value.x,callback:function(e){i.$set(i.prepData.image_spacing.value,"x",i._n(e))},expression:"prepData.image_spacing.value.x"}}),r(Ve["a"],{staticClass:"spacing-input",attrs:{type:"number",label:"Y"},model:{value:i.prepData.image_spacing.value.y,callback:function(e){i.$set(i.prepData.image_spacing.value,"y",i._n(e))},expression:"prepData.image_spacing.value.y"}}),r(Ve["a"],{staticClass:"spacing-input",attrs:{type:"number",label:"Z"},model:{value:i.prepData.image_spacing.value.z,callback:function(e){i.$set(i.prepData.image_spacing.value,"z",i._n(e))},expression:"prepData.image_spacing.value.z"}})],1)],1)]),r(p["a"],[r("div",[r(Ve["a"],{attrs:{type:"number",label:"Number of Samples",min:"1"},model:{value:i.augmentationData.aug_num_samples.value,callback:function(e){i.$set(i.augmentationData.aug_num_samples,"value",i._n(e))},expression:"augmentationData.aug_num_samples.value"}}),r(Ne["a"],{attrs:{items:Object.values(i.Sampler),label:"Sampler Type"},model:{value:i.augmentationData.aug_sampler_type.value,callback:function(e){i.$set(i.augmentationData.aug_sampler_type,"value",e)},expression:"augmentationData.aug_sampler_type.value"}})],1)]),r(p["a"],[r("div",[r(Ne["a"],{attrs:{items:Object.values(i.LossFunction),label:"Loss Function"},model:{value:i.trainingData.train_loss_function.value,callback:function(e){i.$set(i.trainingData.train_loss_function,"value",e)},expression:"trainingData.train_loss_function.value"}}),r(Ve["a"],{attrs:{type:"number",label:"Epochs",min:"0"},model:{value:i.trainingData.train_epochs.value,callback:function(e){i.$set(i.trainingData.train_epochs,"value",i._n(e))},expression:"trainingData.train_epochs.value"}}),r(Ve["a"],{attrs:{type:"number",label:"Learning Rate",min:"0"},model:{value:i.trainingData.train_learning_rate.value,callback:function(e){i.$set(i.trainingData.train_learning_rate,"value",i._n(e))},expression:"trainingData.train_learning_rate.value"}}),r(Ve["a"],{attrs:{type:"number",label:"Batch Size",min:"1"},model:{value:i.trainingData.train_batch_size.value,callback:function(e){i.$set(i.trainingData.train_batch_size,"value",i._n(e))},expression:"trainingData.train_batch_size.value"}}),r(Se["a"],{attrs:{label:"Decay Learning Rate"},model:{value:i.trainingData.train_decay_learning_rate.value,callback:function(e){i.$set(i.trainingData.train_decay_learning_rate,"value",e)},expression:"trainingData.train_decay_learning_rate.value"}}),r(Se["a"],{attrs:{label:"Fine Tuning"},model:{value:i.trainingData.train_fine_tuning.value,callback:function(e){i.$set(i.trainingData.train_fine_tuning,"value",e)},expression:"trainingData.train_fine_tuning.value"}}),r(Ve["a"],{attrs:{disabled:!i.trainingData.train_fine_tuning,type:"number",label:"Fine Tuning Epochs",min:"1"},model:{value:i.trainingData.train_fine_tuning_epochs.value,callback:function(e){i.$set(i.trainingData.train_fine_tuning_epochs,"value",i._n(e))},expression:"trainingData.train_fine_tuning_epochs.value"}}),r(Ve["a"],{attrs:{disabled:!i.trainingData.train_fine_tuning,type:"number",label:"Fine Tuning Learning Rate",min:"0"},model:{value:i.trainingData.train_fine_tuning_learning_rate.value,callback:function(e){i.$set(i.trainingData.train_fine_tuning_learning_rate,"value",i._n(e))},expression:"trainingData.train_fine_tuning_learning_rate.value"}})],1)])],1)],1)],1):i._e(),i.deepSSMResult&&i.deepSSMResult.result?r(nt["a"],[r(rt["a"],[i._v("Data")]),r(it["a"],[r(b["a"],{model:{value:i.deepSSMDataTab,callback:function(e){i.deepSSMDataTab=e},expression:"deepSSMDataTab"}},[r(v["a"],[i._v("Augmentation")]),r(v["a"],[i._v("Training")]),r(v["a"],[i._v("Testing")])],1),r(Ia["a"],{model:{value:i.deepSSMDataTab,callback:function(e){i.deepSSMDataTab=e},expression:"deepSSMDataTab"}},[r(p["a"],[r("div",[r("div",{staticClass:"aug-data-checkboxes"},[r(Ma["a"],{model:{value:i.deepSSMAugDataShown,callback:function(e){i.deepSSMAugDataShown=e},expression:"deepSSMAugDataShown"}},[r(Ea["a"],{attrs:{value:"Original",label:"Original Data"}}),r(Ea["a"],{attrs:{value:"Generated",label:"Generated Data"}})],1)],1),r(xe["a"],{attrs:{items:i.dataTables.aug_table.value,headers:i.dataTables.aug_headers.value}}),r("h4",[i._v("Violin Plot")]),r(Pa["a"],{attrs:{src:null===(e=i.deepSSMResult.result)||void 0===e?void 0:e.aug_visualization,alt:"Augmented Data Violin Plot"}})],1)]),r(p["a"],[r("div",[r(xe["a"],{attrs:{items:i.dataTables.training_table.value,headers:i.dataTables.training_headers.value}}),i._v(" Training Plot "),r(Pa["a"],{attrs:{src:null===(t=i.deepSSMResult.result)||void 0===t?void 0:t.training_visualization,alt:"Training Plot"}}),null!==(a=i.deepSSMResult.result)&&void 0!==a&&a.training_visualization_ft?r("div",[i._v(" Fine Tuning Plot "),r(Pa["a"],{attrs:{src:null===(n=i.deepSSMResult.result)||void 0===n?void 0:n.training_visualization_ft,alt:"Fine Tuning Plot"}})],1):i._e()],1)]),r(p["a"],[r("div",[r(xe["a"],{attrs:{items:i.dataTables.testing_table.value,headers:i.dataTables.testing_headers.value}})],1)])],1)],1)],1):i._e()],1)],1)},Ta=[],La={components:{TaskInfo:Qt["a"]},setup(){let e,t;(function(e){e["Gaussian"]="Gaussian",e["Mixture"]="mixture",e["KDE"]="KDE"})(e||(e={})),function(e){e["MSE"]="MSE",e["Focal"]="Focal"}(t||(t={}));const a=Object(n["ref"])(0),i=Object(n["ref"])(),r=Object(n["ref"])(!1),s=Object(n["ref"])(),l=Object(n["ref"])({}),o={testing_split:Object(n["ref"])(20),validation_split:Object(n["ref"])(20),percent_variability:Object(n["ref"])(95),image_spacing:Object(n["ref"])({x:1,y:1,z:1})},c={aug_num_samples:Object(n["ref"])(300),aug_sampler_type:Object(n["ref"])(e.Gaussian)},u={train_loss_function:Object(n["ref"])(t.MSE),train_epochs:Object(n["ref"])(100),train_learning_rate:Object(n["ref"])(.001),train_batch_size:Object(n["ref"])(8),train_decay_learning_rate:Object(n["ref"])(!0),train_fine_tuning:Object(n["ref"])(!0),train_fine_tuning_epochs:Object(n["ref"])(100),train_fine_tuning_learning_rate:Object(n["ref"])(.001)},d={aug_table:Object(n["ref"])(void 0),aug_headers:Object(n["ref"])(void 0),training_table:Object(n["ref"])(void 0),training_headers:Object(n["ref"])([{text:"Training Stage",value:"0"},{text:"Epoch",value:"1"},{text:"LR",value:"2"},{text:"Train_Err",value:"3"},{text:"Train_Rel_Err",value:"4"},{text:"Val_Err",value:"5"},{text:"Val_Rel_Err",value:"6"},{text:"Sec",value:"7"}]),testing_table:Object(n["ref"])(void 0),testing_headers:Object(n["ref"])([{text:"Name",value:"0"},{text:"Distance",value:"1"}])};function v(e){return Object.entries(e).map(([e,t])=>[e,t.value]).reduce((e,[t,a])=>(e[t]=a,e),{})}function p(){const e=v(o),t=v(c),a=v(u);return{...e,...t,...a,...q["U"].value,...q["xb"].value}}function b(){s.value=l.value,Object.entries(s.value).forEach(([e,t])=>{o[e]&&(o[e].value=t),c[e]&&(c[e].value=t),u[e]&&(u[e].value=t)})}function f(){var e;const t=null===(e=q["Kb"].value)||void 0===e?void 0:e.file_contents;if(t){const e=t["deepssm"];l.value=Object.fromEntries(Object.entries(l.value).map(([t,a])=>(e[t]&&(a=e[t]),"True"===a?a=!0:"False"===a?a=!1:"string"!==typeof a||isNaN(parseFloat(a))||(a=parseFloat(a)),[t,a])))}}async function m(e){return await Object(O["e"])(e)}return Object(n["onMounted"])(async()=>{if(l.value=p(),f(),b(),!q["I"].value&&q["Kb"].value&&(q["H"].value=!0,await Object(q["pb"])(),q["H"].value=!1),q["I"].value&&q["I"].value.result)try{Promise.all([await m(q["I"].value.result.aug_total_data),await m(q["I"].value.result.training_data_table),await m(q["I"].value.result.testing_distances)]).then(e=>{const t=e[0].map(e=>{const t={};return Object.keys(e).forEach(a=>{const n=e[a];t[a]="string"===typeof n?n.split("/").pop():n}),t});d.aug_table.value=t,d.training_table.value=e[1],d.testing_table.value=e[2],d.aug_headers.value=Object.keys(d.aug_table.value[0]).map((e,t)=>({text:""+(t+1),value:""+t}))})}catch(e){console.error(e)}}),Object(n["watch"])(a,()=>{1===a.value&&-1===q["F"].value&&(q["F"].value=0)}),Object(n["watch"])(q["F"],()=>{q["G"].value=[0,1]}),Object(n["watch"])([c.aug_num_samples,c.aug_sampler_type,u.train_loss_function,u.train_epochs,u.train_learning_rate,u.train_batch_size,u.train_decay_learning_rate,u.train_fine_tuning,u.train_fine_tuning_epochs,u.train_fine_tuning_learning_rate],()=>{s.value=p()}),{selectedProject:q["Kb"],openExpansionPanel:a,controlsTabs:i,prepData:o,formData:s,resetForm:b,augmentationData:c,trainingData:u,Sampler:e,LossFunction:t,abort:q["c"],showAbortConfirmation:r,deepSSMDataTab:q["F"],deepSSMResult:q["I"],deepSSMAugDataShown:q["E"],deepSSMLoadingData:q["H"],dataTables:d}}},Ra=La,Fa=(a("360a"),Object(je["a"])(Ra,Aa,Ta,!1,null,null,null)),Wa=Fa.exports,Na={components:{ShapeViewer:we,DataList:Re,InfoTab:ka,RenderControls:Je,TabForm:tt,AnalysisTab:na,DeepSSMTab:Wa},props:{dataset:{type:Number,required:!0},project:{type:Number,required:!0}},setup(e){const t=Object(n["ref"])(600),a=Object(n["ref"])(),i=Object(n["computed"])(()=>{let e=`calc(100% - ${t.value}px)`;return{width:e,position:"absolute",left:t.value+"px",top:q["cb"].value?"140px":"70px",height:q["cb"].value?"calc(100% - 140px)":"calc(100% - 70px)"}}),r=Object(n["ref"])(),s=Object(n["ref"])(1),l=Object(n["ref"])(1),o=Object(n["ref"])({}),c=Object(n["ref"])({});function u(){b()}async function d(){var e;q["Kb"].value=void 0,q["m"].value=void 0,0===q["f"].value.length&&q["Jb"].value&&Object(q["tb"])(q["Jb"].value.id),gn.push("/dataset/"+(null===(e=q["Jb"].value)||void 0===e?void 0:e.id))}function v(){if(a.value&&a.value.$el){let e=a.value.$el.querySelector(".v-navigation-drawer__border");e.style.width="10px",e.style.cursor="ew-resize",e.addEventListener("mousedown",(function(e){e.preventDefault(),e.offsetX<300&&(a.value.$el.style.transition="initial",document.addEventListener("mousemove",p,!1))}),!1),document.addEventListener("mouseup",(function(){a.value&&(a.value.$el.style.transition=""),document.body.style.cursor="",document.removeEventListener("mousemove",p,!1)}),!1)}}function p(e){document.body.style.cursor="ew-resize",a.value.$el.style.width=e.clientX+"px",t.value=e.clientX}async function b(){var e,a,n;let i,u;if(q["nb"].value.includes("Landmarks")&&!q["h"].value&&(i=Object(q["R"])().then(()=>{q["lb"].value=!1})),q["nb"].value.includes("Constraints")&&!q["g"].value&&(u=Object(q["P"])().then(()=>{q["x"].value=!1})),0==q["Ib"].value.length)return Promise.all([i,u]);q["Fb"].value=!0,q["cb"].value=!1;let d={},v={};const p=Object(O["c"])(q["Ib"].value,"subject");if(null!==(e=q["m"].value)&&void 0!==e&&e.length&&null!==(a=q["z"].value)&&void 0!==a&&a.length&&null!==(n=q["wb"].value)&&void 0!==n&&n.length)await Promise.all(q["m"].value.map(async(e,t)=>{if(q["wb"].value&&q["z"].value){const a=0===q["l"].value?"PCA":"GROUP";d[a]||(d[a]=[]),d[a].push({shape:[await Object(y["a"])(e,Object(O["h"])(e))],points:await Object(j["a"])(q["z"].value[t])}),v[a]||(v[a]=[]);const n=await Object(j["a"])(q["wb"].value[t]),i=await Object(j["a"])(q["z"].value[t]);v[a].push({mean:{shape:await Object(y["a"])(void 0),points:n},current:{shape:await Object(y["a"])(void 0),points:i}})}}));else if("deepssm"===r.value&&q["I"].value){let e=p;const t=q["I"].value.images,a=q["I"].value.aug_pairs;switch(q["F"].value){case 0:if("Generated"===q["E"].value){const t=a.slice(q["a"]*(q["J"].value-1),q["a"]*q["J"].value);e=Object(O["c"])(t,"sample_num")}else e=p;break;case 1:e=q["I"].value.training_pairs.reduce((e,t)=>{const a=`${t.example_type}_${t.validation}`;return e[a]||(e[a]=[]),e[a].push(t),e},{});const t=["best","median","worst"];e=Object.fromEntries(Object.entries(e).sort(([e,a],[n,i])=>{const r=e.split("_"),s=n.split("_");return"true"===r[1]&&"true"===s[1]?t.indexOf(r[0])-t.indexOf(s[0]):"true"===r[1]?-1:"true"===s[1]?1:t.indexOf(r[0])-t.indexOf(s[0])}));break;case 2:e=Object(O["c"])(q["I"].value.test_pairs,"image_id"),e=Object.fromEntries(Object.entries(e).map(([e,t])=>{const a=t.filter(e=>"world"===e.image_type);return[e,a]}));break;default:break}d=Object.fromEntries(await Promise.all(Object.entries(e).map(async([e,n])=>{let i=e;if(n[0].example_type&&(i=`${n[0].example_type} ${n[0].validation?"validation":"training"}`),n[0].sample_num&&(i="Generated_Sample_"+e),q["i"].value){const t=q["i"].value.find(t=>t.id.toString()===e);t&&(i=t.name)}const r=(await Promise.all(n.map(e=>{const n=[];let r,s,l;if("sample_num"in e){const t=e;r=t.mesh,s=t.image,l=t.particles,n.push(Object(y["a"])(s,i+".nrrd")),n.push(Object(y["a"])(r,i+".vtk"))}else if("example_type"in e){const u=e;if(r=u.mesh,l=u.particles,u.index.startsWith("Generated_sample_")){var o;const e=parseInt(u.index.split("_")[2]);s=null===(o=a.find(t=>t.sample_num===e))||void 0===o?void 0:o.image}else{var c;s=null===(c=t.find(e=>e.index===u.index))||void 0===c?void 0:c.image}n.push(Object(y["a"])(s,i+".nrrd")),n.push(Object(y["a"])(r,i+".vtk","DeepSSM"))}else if("image_id"in e){var u;const t=e;r=t.mesh,l=t.particles;const a=t.image_id,s=null===(u=q["i"].value.find(e=>e.name.toString()===a))||void 0===u?void 0:u.id,o=q["d"].value.find(e=>e.subject===s),c=null===o||void 0===o?void 0:o.file;n.push(Object(y["a"])(c,i+".nrrd")),n.push(Object(y["a"])(r,i+".vtk","DeepSSM"))}else r=e.file,"anatomy_type"in e?n.push(Object(y["a"])(r,i+".vtk","Original")):n.push(Object(y["a"])(r,i+".nrrd","Original"));return Promise.all([Promise.all(n),Object(j["a"])(l)])}))).map(e=>({shape:e[0],points:e[1]}));return[i,r]})))}else d=Object.fromEntries(await Promise.all(Object.entries(p).map(async([e,t])=>{let a=e;if(q["i"].value){const t=q["i"].value.find(t=>t.id.toString()===e);t&&(a=t.name)}const n=(await Promise.all(t.map(e=>{const t=[];if(q["nb"].value.includes("Original")){const a=e.anatomy_type?"Original":"Original - Image";t.push(Object(y["a"])(e.file,Object(O["h"])(e.file),a,e.anatomy_type&&{domain:e.anatomy_type.replace("anatomy_","")}))}if(q["nb"].value.includes("Groomed")&&q["V"].value[e.type]&&q["V"].value[e.type][e.id]){var a;const n=null===(a=q["V"].value[e.type][e.id])||void 0===a?void 0:a.file;n&&t.push(Object(y["a"])(n,Object(O["h"])(n),"Groomed",{domain:e.anatomy_type.replace("anatomy_","")}))}if(q["nb"].value.includes("Reconstructed")){const a=q["Eb"].value.find(t=>{const a=t.particles;let n;return"mesh"===e.type?n=a.groomed_mesh.mesh:"segmentation"===e.type&&(n=a.groomed_segmentation.segmentation),n===e.id});if(a){const e=a.file;t.push(Object(y["a"])(e,Object(O["h"])(e),"Reconstructed",{domain:a.anatomy_type.replace("anatomy_","")}))}}let n;var r;q["nb"].value.includes("Particles")&&(n=null===(r=q["Ab"].value[e.type][e.id])||void 0===r?void 0:r.local);return Promise.all([Promise.all(t),Object(j["a"])(n),i,u])}))).map(([e,t,a,n])=>({shape:e,points:t,landmarks:a,constraints:n}));return[a,n]})));const b=Object.keys(d).length,f=Math.ceil(Math.sqrt(b)),m=Math.min(f,5),g=window.innerWidth-t.value,h=window.innerHeight-120,_=g/h;_>1?(s.value=Math.ceil(b/m),l.value=m):(l.value=Math.ceil(b/m),s.value=m),o.value=d,c.value=v}Object(n["onMounted"])(async()=>{try{await Object(q["ob"])(e.dataset),await Object(q["sb"])(e.project)}catch(t){console.log(t),d()}Object(n["nextTick"])(()=>{window.addEventListener("resize",u)})}),Object(n["onBeforeUnmount"])(()=>{window.removeEventListener("resize",u)});const f=_.a.debounce(b,300);return Object(n["watch"])(a,v),Object(n["watch"])(q["Ib"],f),Object(n["watch"])(q["nb"],f),Object(n["watch"])(q["m"],f,{deep:!0}),Object(n["watch"])(q["wb"],f,{deep:!0}),Object(n["watch"])(q["F"],f),Object(n["watch"])(q["E"],f),Object(n["watch"])(q["Tb"],f),Object(n["watch"])(q["J"],f),Object(n["watch"])(r,q["Sb"]),{loadingState:q["vb"],renderLoading:q["Fb"],drawer:a,drawerWidth:t,setDrawerWidth:p,renderAreaStyle:i,tab:r,rows:s,cols:l,renderData:o,renderMetaData:c,selectedDataset:q["Jb"],selectedProject:q["Kb"],selectedDataObjects:q["Ib"],toSelectPage:d,refreshRender:b,jobAlreadyDone:q["hb"],particleSize:q["zb"],analysisFilesShown:q["m"]}}},za=Na,Ka=(a("4251"),Object(je["a"])(za,m,g,!1,null,null,null)),Va=Ka.exports,Ua=function(){var e=this,t=e._self._c;return t("div",[e.selectedDataset?t("div",{staticClass:"flex-container pa-5"},[t("div",{staticStyle:{width:"100%"}},[t(s["a"],{on:{click:e.back}},[e._v(" mdi-arrow-left ")]),e._v(" "+e._s(e.selectedDataset.name)+" ")],1),void 0!==e.allProjectsForDataset&&0!==e.allProjectsForDataset.length||e.loadingState?e._e():t(r["a"],{attrs:{width:"100%"}},[t(sa["c"],[e._v("No projects.")])],1),e._l(e.sortedProjects,(function(a){return t("div",{key:"project_"+a.id,on:{click:()=>e.selectOrDeselectProject(a)}},[e.editingProject===a?t("project-form",{attrs:{editMode:""},on:{cancel:()=>e.editingProject=void 0}}):t(r["a"],{directives:[{name:"show",rawName:"v-show",value:!e.selectedProject||e.selectedProject==a,expression:"!selectedProject || selectedProject == project"}],class:a.thumbnail?"selectable-card with-thumbnail":"selectable-card",attrs:{width:e.selectedProject==a?"100%":""}},[t("div",{staticClass:"text-overline mb-4"},[e._v(" PROJECT ("+e._s(a.created?a.created.split("T")[0]:"No creation time")+") FOR DATASET "+e._s(e.selectedDataset.id)+" "),a.readonly?t("span",{staticClass:"blue--text"},[e._v(" (READ ONLY) ")]):e._e(),a.private?t("span",{staticClass:"red--text"},[e._v(" (PRIVATE) ")]):e._e()]),t("div",{staticClass:"card-contents"},[t("div",[t(o["c"],{staticClass:"text-h5 mb-1"},[e._v(" "+e._s(a.name)+" ")]),t(o["b"],[e._v(" "+e._s(a.description)+" ")]),a.keywords?t(o["b"],e._l(a.keywords.split(","),(function(a){return t(We["a"],{key:a,attrs:{small:""}},[t("i",[e._v(e._s(a))])])})),1):e._e()],1),a.thumbnail?t("div",[t(Pa["a"],{attrs:{src:a.thumbnail,width:"100"}})],1):e._e()]),t(sa["a"],{staticClass:"action-buttons"},[t(Fe["a"],{staticStyle:{width:"40%","margin-left":"8px"},attrs:{outlined:"",rounded:"",text:""},on:{click:function(t){return t.stopPropagation(),(()=>e.cloneProj(a)).apply(null,arguments)}}},[e._v(" Clone ")]),t(Fe["a"],{staticStyle:{width:"40%"},attrs:{outlined:"",rounded:"",text:""},on:{click:function(t){t.stopPropagation(),e.editingProject=a}}},[e._v(" Edit ")]),t(Fe["a"],{staticStyle:{width:"40%"},attrs:{outlined:"",rounded:"",text:"",color:"blue"},on:{click:function(t){return t.stopPropagation(),(()=>e.selectOrDeselectProject(a)).apply(null,arguments)}}},[e._v(" Select ")]),t(Fe["a"],{staticStyle:{width:"40%"},attrs:{outlined:"",rounded:"",text:"",color:"red"},on:{click:function(t){t.stopPropagation(),e.deleting=a}}},[e._v(" Delete ")])],1)],1)],1)})),t("project-form"),t(at["a"],{attrs:{value:e.deleting,width:"500"}},[e.deleting?t(r["a"],[t(sa["c"],{staticClass:"text-h5"},[e._v(" Confirmation ")]),t(sa["b"],[e._v(' Are you sure you want to delete project "'+e._s(e.deleting.name)+'"? ')]),t(At["a"]),t(sa["a"],[t(ca["a"]),t(Fe["a"],{attrs:{text:""},on:{click:function(t){t.stopPropagation(),e.deleting=void 0}}},[e._v(" Cancel ")]),t(Fe["a"],{attrs:{text:"",color:"red"},on:{click:function(t){return t.stopPropagation(),e.deleteProj.apply(null,arguments)}}},[e._v(" Delete ")])],1)],1):e._e()],1)],2):e._e()])},Ba=[],$a=function(){var e=this,t=e._self._c;return t("div",[e.creating||e.editMode?t(r["a"],{staticClass:"selectable-card",attrs:{ripple:!1},on:{click:function(e){e.stopPropagation()}}},[e.editMode?e._e():t("div",{staticClass:"text-overline mb-4"},[e._v(" NEW PROJECT FOR DATASET "+e._s(e.selectedDataset.id)+" ")]),t("form",{attrs:{submit:e.submit}},[t(Ve["a"],{staticClass:"text-h5 mb-1",attrs:{autofocus:""},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),t(Ve["a"],{attrs:{label:"Description"},model:{value:e.description,callback:function(t){e.description=t},expression:"description"}}),t(Ve["a"],{attrs:{label:"Keywords"},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}}),t(Se["a"],{attrs:{dense:"",label:"Make this project read only"},model:{value:e.readonly,callback:function(t){e.readonly=t},expression:"readonly"}}),e.creating?t(Se["a"],{attrs:{dense:"",label:"Make this project private"},model:{value:e.privated,callback:function(t){e.privated=t},expression:"privated"}}):e._e(),t(sa["a"],{staticClass:"action-buttons"},[t(Fe["a"],{attrs:{outlined:"",rounded:"",text:"",type:"submit"},on:{click:function(t){return t.stopPropagation(),e.submit.apply(null,arguments)}}},[e._v(" "+e._s(e.editMode?"Save":"Create")+" ")]),t(Fe["a"],{attrs:{outlined:"",rounded:"",text:""},on:{click:function(t){return t.stopPropagation(),e.cancel.apply(null,arguments)}}},[e._v(" Cancel ")])],1)],1)]):t(Fe["a"],{staticClass:"new-button",on:{click:function(t){t.stopPropagation(),e.creating=!0}}},[e._v(" + New Project ")])],1)},Ga=[],qa={props:{editMode:{type:Boolean,default:!1}},setup(e,{emit:t}){const a=Object(n["ref"])(!1),i=Object(n["ref"])("My Project"),r=Object(n["ref"])(""),s=Object(n["ref"])(""),l=Object(n["ref"])(!1),o=Object(n["ref"])(!1);function c(){a.value=!1,r.value="",s.value=""}function u(){e.editMode?t("cancel"):a.value=!1}function d(t){t.preventDefault(),q["vb"].value=!0;const a={name:i.value,private:l.value,dataset:q["Jb"].value.id,description:r.value,keywords:s.value,readonly:o.value};let n=async()=>await Object(Ie["d"])(a);e.editMode&&(n=async()=>await Object(Ie["g"])(q["K"].value.id,a)),n().then(async e=>{201===e.status?Object(q["tb"])(q["Jb"].value.id):200===e.status&&(Object(q["tb"])(q["Jb"].value.id),q["K"].value=void 0),q["vb"].value=!1,c()}).catch(e=>{console.log(e),q["vb"].value=!1})}return e.editMode&&(i.value=q["K"].value.name,r.value=q["K"].value.description,s.value=q["K"].value.keywords,l.value=q["K"].value.private,o.value=q["K"].value.readonly),{creating:a,name:i,selectedDataset:q["Jb"],loadingState:q["vb"],description:r,keywords:s,privated:l,readonly:o,editingProject:q["K"],cancel:u,submit:d}}},Ja=qa,Ha=(a("d0c6"),Object(je["a"])(Ja,$a,Ga,!1,null,"102049a3",null)),Za=Ha.exports,Ya={components:{ProjectForm:Za},props:{dataset:{type:Number,required:!0},searchText:{type:String,required:!1}},setup(e){const t=Object(n["ref"])(),a=Object(n["computed"])(()=>{if(q["f"].value){let e=q["f"].value.sort((e,t)=>{let a=e[q["Qb"].value],n=t[q["Qb"].value];return a&&n?a<n?!0===q["Pb"].value?-1:1:a>n?!0===q["Pb"].value?1:-1:0:0});return e=e.filter(e=>q["M"].value.private&&q["M"].value.readonly?!e.private&&!e.readonly:q["M"].value.private?!e.private:!q["M"].value.readonly||!e.readonly),e}return[]});async function i(t){q["Kb"].value?(q["Kb"].value=void 0,q["Ib"].value=[],await Object(q["N"])()):(Object(q["Gb"])(t.id),gn.push(`/dataset/${e.dataset}/project/${t.id}`))}function r(t){q["vb"].value=!0,Object(Ie["c"])(t.id).then(()=>{Object(q["tb"])(e.dataset),q["vb"].value=!1})}function s(){q["vb"].value=!0,Object(Ie["f"])(t.value.id).then(()=>{t.value=void 0,Object(q["tb"])(e.dataset),q["Jb"].value&&(q["Kb"].value=void 0),q["vb"].value=!1})}function l(){q["Jb"].value=void 0,gn.push("/")}function o(){void 0!==q["Jb"].value&&q["Jb"].value.id===e.dataset||(Object(q["ob"])(e.dataset),Object(q["tb"])(e.dataset))}return Object(n["onMounted"])(o),Object(n["watch"])(()=>e.dataset,o),Object(n["watch"])(()=>e.searchText,()=>Object(q["tb"])(e.dataset)),{selectedDataset:q["Jb"],allProjectsForDataset:q["f"],selectedProject:q["Kb"],selectOrDeselectProject:i,cloneProj:r,deleting:t,deleteProj:s,editingProject:q["K"],selectProject:q["Gb"],back:l,loadingState:q["vb"],sortedProjects:a}}},Xa=Ya,Qa=Object(je["a"])(Xa,Ua,Ba,!1,null,null,null),en=Qa.exports,tn=function(){var e=this,t=e._self._c;return t("div",[e.selectedDataset?e._e():t("div",{staticClass:"flex-container pa-5",style:e.selectingSubsetOf?"width: calc(100% - 500px)":""},[0!==e.allDatasets.length||e.loadingState?e._e():t(r["a"],{attrs:{width:"100%"}},[t(sa["c"],[e._v("No datasets.")])],1),e._l(e.sortedDatasets,(function(a){return t(r["a"],{directives:[{name:"show",rawName:"v-show",value:!e.selectedDataset||e.selectedDataset==a,expression:"!selectedDataset || selectedDataset == dataset"}],key:"dataset_"+a.id,class:a.thumbnail?"selectable-card with-thumbnail":"selectable-card",attrs:{width:e.selectedDataset==a?"100%":""},on:{click:()=>e.selectOrDeselectDataset(a)}},[t("div",{staticClass:"text-overline mb-4"},[e._v(" DATASET ("+e._s(a.created?a.created.split("T")[0]:"No creation time")+") "),a.private?t("span",{staticClass:"red--text"},[e._v(" (PRIVATE) ")]):e._e()]),t("div",{staticClass:"card-contents"},[t("div",[t(o["c"],{staticClass:"text-h5 mb-1"},[e._v(" "+e._s(a.name)+" ")]),t(o["b"],[e._v(" "+e._s(a.description)+" ")]),t("div",{staticClass:"text-overline"},[e._v(" "+e._s(a.summary)+" ")]),a.keywords?t(o["b"],e._l(a.keywords.split(","),(function(a){return t(We["a"],{key:a,attrs:{small:""}},[t("i",[e._v(e._s(a))])])})),1):e._e()],1),a.thumbnail?t("div",[t(Pa["a"],{attrs:{src:a.thumbnail,width:"100"}})],1):e._e()]),t(sa["a"],{staticClass:"action-buttons"},[t(Fe["a"],{attrs:{outlined:"",rounded:"",text:""},on:{click:function(t){return t.stopPropagation(),(()=>e.selectOrDeselectDataset(a)).apply(null,arguments)}}},[e._v(" "+e._s(e.selectedDataset?"Deselect":"Select")+" ")]),t(Fe["a"],{attrs:{outlined:"",rounded:"",text:""},on:{click:function(t){return t.stopPropagation(),(()=>e.selectingSubsetOf=a).apply(null,arguments)}}},[e._v(" Create subset ")])],1)],1)}))],2),t(c["a"],{attrs:{right:"",absolute:"",width:"500px",value:void 0!==e.selectingSubsetOf&&!e.selectedDataset}},[t(Fe["a"],{staticClass:"pa-3 pt-8",attrs:{icon:""},on:{click:function(t){t.stopPropagation(),e.selectingSubsetOf=void 0}}},[t(s["a"],[e._v("mdi-close")])],1),e.selectingSubsetOf?t("subset-selection",{attrs:{targetDataset:e.selectingSubsetOf},on:{close:function(t){e.selectingSubsetOf=void 0}}}):e._e()],1)],1)},an=[],nn=function(){var e=this,t=e._self._c;return t("div",{staticClass:"px-3 pt-10",staticStyle:{position:"relative"}},[t("div",{staticClass:"submitButton"},[t("div",{staticClass:"text-overline mb-4"},[e._v(" CREATE NEW DATASET FROM SUBSET OF "+e._s(e.targetDataset.name)+" ")]),t(Fe["a"],{staticClass:"mt-3",attrs:{color:"primary",disabled:""===e.name||0===e.selectedDataObjects.length},on:{click:e.submitForm}},[e._v(" Create subset ")])],1),t("br"),t(Ve["a"],{attrs:{autofocus:"",label:"Subset name"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),t(Ve["a"],{attrs:{label:"Description"},model:{value:e.description,callback:function(t){e.description=t},expression:"description"}}),t(Ve["a"],{attrs:{label:"Keywords"},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}}),e._v(" Select anatomies and subjects from "+e._s(e.targetDataset.name)+" to include in new dataset: "),t("data-list",{attrs:{autoSelectAll:"",dataset:e.targetDataset.id}})],1)},rn=[],sn={components:{DataList:Re},props:{targetDataset:{type:Object,required:!0}},setup(e,t){const a=Object(n["ref"])(""),i=Object(n["ref"])(""),r=Object(n["ref"])("");async function s(){const n=q["Ib"].value.map(e=>({id:e.id,subject:e.subject,type:e.type})),s=await Object(Ie["D"])(e.targetDataset.id,{name:a.value,description:i.value,keywords:r.value,selected:n});s&&(q["e"].value.push(s),t.emit("close"))}return{name:a,description:i,keywords:r,submitForm:s,selectedDataObjects:q["Ib"]}}},ln=sn,on=(a("1d10"),Object(je["a"])(ln,nn,rn,!1,null,null,null)),cn=on.exports,un={components:{SubsetSelection:cn},props:{searchText:{type:String,required:!1}},setup(e){const t=Object(n["ref"])();q["Jb"].value=void 0;const a=Object(n["computed"])(()=>{if(q["e"].value){const e=q["e"].value.sort((e,t)=>{let a=e[q["Qb"].value],n=t[q["Qb"].value];return a&&n?a<n?!0===q["Pb"].value?-1:1:a>n?!0===q["Pb"].value?1:-1:0:0});return e}return[]});async function i(e){!q["Jb"].value&&e?(q["Jb"].value=e,gn.push("/dataset/"+e.id),Object(q["tb"])(e.id)):(q["Jb"].value=void 0,q["Ib"].value=[],await Object(q["N"])())}return Object(n["onMounted"])(async()=>{if(await Object(q["N"])(),q["Jb"].value){const e=q["Jb"].value.id;q["Jb"].value=q["e"].value.find(t=>t.id==e)}}),Object(n["watch"])(()=>e,()=>{Object(q["N"])(),q["Jb"].value=void 0},{deep:!0}),{allDatasets:q["e"],selectedDataset:q["Jb"],selectOrDeselectDataset:i,selectingSubsetOf:t,loadingState:q["vb"],sortedDatasets:a}}},dn=un,vn=(a("2aea"),Object(je["a"])(dn,tn,an,!1,null,null,null)),pn=vn.exports;n["default"].use(i["a"]);const bn=e=>({dataset:e.params.dataset?parseInt(e.params.dataset):void 0,project:e.params.project?parseInt(e.params.project):void 0,searchText:e.params.searchText}),fn=[{path:"/dataset/:dataset/project/:project",name:"main",props:bn,component:Va},{path:"/dataset/:dataset/search/:searchText",name:"project-search",props:bn,component:en},{path:"/search/:searchText",name:"dataset-search",props:bn,component:pn},{path:"/dataset/:dataset",name:"project-select",props:bn,component:en},{path:"/",name:"dataset-select",props:bn,component:pn},{path:"*",redirect:"/"}],mn=new i["a"]({routes:fn});var gn=t["a"]=mn},"61ca":function(e,t,a){"use strict";a("2226")},6634:function(e,t,a){"use strict";a("5cf4")},"78fb":function(e,t,a){},"791f":function(e,t,a){},"7d6ca":function(e,t,a){"use strict";a("78fb")},"85ce":function(e,t,a){},"867c":function(e,t,a){},8998:function(e,t,a){"use strict";a("918d")},"918d":function(e,t,a){},"95ed":function(e,t,a){},"99ce":function(e,t,a){"use strict";a("14d9");var n=a("eb45"),i=a("a3a2"),r=a("9070"),s=a("4d95"),l=a("9941"),o=a("7b05"),c=a("9efe"),u=a("4614"),d=a("bc3a"),v=a.n(d),p=a("c28d"),b=async function(e){const t=p["a"].newInstance();await t.setUrl(e,{binary:!0});const a=t.getOutputData();return a.getPointData().setActiveScalars("does-not-exist"),a},f=a("0613");const{convertItkToVtkImage:m}=u["a"];async function g(e){if(!e)return o["a"].newInstance({name:"deepssm_error"});const t=s["a"].newInstance();await t.setUrl(e);t.getOutputData();const a=(await v.a.get(e)).data,n=[];a.split("\r\n\r").forEach(e=>{if(e.includes("deepssm_error")){const[t,a]=e.split("deepssm_error"),i=a.slice(1).split("\r\n").map(e=>e.split(" ").map(e=>parseFloat(e)).filter(e=>e)).pop();i&&n.push(...i)}});const i=[Math.min(...n),Math.max(...n)];f["G"].value=[Math.min(f["G"].value[0],i[0]),Math.max(f["G"].value[1],i[1])];const r=o["a"].newInstance({name:"deepssm_error",values:n});return r}t["a"]=async function(e,t="",a="Original",o={}){let u=n["a"].newInstance();if(!e)return u;const d=(await v.a.get(e,{responseType:"arraybuffer"})).data;if(t.toLowerCase().endsWith("ply")){const e=i["a"].newInstance();await e.parseAsArrayBuffer(d),u=e.getOutputData()}else if(t.toLowerCase().endsWith("nrrd")||t.toLowerCase().endsWith("nii")||t.toLowerCase().endsWith("nii.gz")){const{image:e}=await Object(c["a"])(null,d,t);u=m(e)}else if(t.toLowerCase().endsWith("vtp"))u=await b(e);else if(t.toLowerCase().endsWith("vtk")){const t=s["a"].newInstance();await t.setUrl(e),u=t.getOutputData()}else if(t.toLowerCase().endsWith("stl")){const e=r["a"].newInstance();await e.parseAsArrayBuffer(d),u=e.getOutputData()}else console.log("Unknown file type for",t),u=n["a"].newInstance();const p=u.getFieldData();if(Object.entries(o).forEach(([e,t])=>{const a=t.toString(),n=l["a"].newInstance({name:e,size:1});n.setData([a],1),p.addArray(n)}),"DeepSSM"===a){const t=await g(e);u.getPointData().addArray(t)}return f["Vb"].value[a].push(u),u}},"9baa":function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"c",(function(){return c})),a.d(t,"d",(function(){return u})),a.d(t,"b",(function(){return d}));a("14d9");var n=a("bc3a"),i=a.n(n),r=a("7074"),s=a("0613"),l=a("5f86");const o=i.a.create({baseURL:"https://app.shapeworks-cloud.org/api/v1/"}),c=new r["a"]("https://app.shapeworks-cloud.org/oauth/","kNREkFvALDHTgTInKEdtNbvd6k9XUNN3dBytvaSr");async function u(){c&&await c.maybeRestoreLogin()}o.interceptors.request.use(e=>({...e,headers:{...null===c||void 0===c?void 0:c.authHeaders,...e.headers}})),o.interceptors.response.use(e=>e,e=>{var t,a;if(500===(null===(t=e.response)||void 0===t?void 0:t.status))s["B"].value="Server error; see server logs for details.";else if(404===(null===(a=e.response)||void 0===a?void 0:a.status))s["B"].value="Not found.";else if(e.response){var n;s["B"].value=null===(n=e.response)||void 0===n?void 0:n.data}else s["B"].value="An error occurred.";return{data:void 0}});const d=async()=>{try{await o.post("/logout/",null,{withCredentials:!0})}finally{await c.logout(),l["a"].push("/")}}},a038:function(e,t,a){"use strict";a("a5d5")},a1af:function(e,t,a){},a314:function(e,t,a){"use strict";var n=a("8336"),i=a("b0af"),r=a("99d9"),s=a("169a"),l=a("ce7e"),o=a("8e36"),c=a("2fa4"),u=function(){var e=this,t=e._self._c;return t("div",{staticClass:"pa-3"},[e.taskData?t("div",[e.taskData.message&&!e.taskData.error?t("div",{staticStyle:{"text-align":"center"}},[e._v(e._s(e.taskData.message))]):e._e(),e.taskData.error?t("div",{staticClass:"red--text",staticStyle:{"text-align":"center"}},[e._v("Error: "+e._s(e.taskData.error))]):t(o["a"],{attrs:{value:e.taskData.percent_complete}}),e.taskData.abort?e._e():t("div",{staticClass:"d-flex pa-3",staticStyle:{width:"100%","justify-content":"space-around"}},[t(n["a"],{attrs:{color:"red"},on:{click:()=>e.showAbortConfirmation=!0}},[e._v(" Abort ")])],1),t("br")],1):e._e(),t("div",{staticStyle:{display:"flex",width:"100%","justify-content":"space-between"}},[t(n["a"],{attrs:{disabled:e.resetDisabled},on:{click:e.resetForm}},[e._v(" Reset form ")]),t(n["a"],{staticStyle:{float:"right"},attrs:{color:"primary",disabled:e.submitDisabled},on:{click:e.submitForm}},[e._v(" "+e._s(e.alreadyDone?"Rerun":"Run")+" "+e._s(e.props.taskName)+" ")])],1),t(s["a"],{attrs:{width:"500"},model:{value:e.showSubmissionConfirmation,callback:function(t){e.showSubmissionConfirmation=t},expression:"showSubmissionConfirmation"}},[t(i["a"],[t(r["c"],[e._v(" Confirmation ")]),t(r["b"],[e._v(" Are you sure you want to re-run the "+e._s(e.props.taskName)+" job? The previous results will be overwritten. ")]),t(l["a"]),t(r["a"],[t(c["a"]),t(n["a"],{attrs:{text:""},on:{click:()=>{e.showSubmissionConfirmation=!1}}},[e._v(" Cancel ")]),t(n["a"],{attrs:{color:"primary",text:""},on:{click:()=>{e.showSubmissionConfirmation=!1,e.submitForm(void 0,!0)}}},[e._v(" Yes, Rerun ")])],1)],1)],1),t(s["a"],{attrs:{width:"500"},model:{value:e.showAbortConfirmation,callback:function(t){e.showAbortConfirmation=t},expression:"showAbortConfirmation"}},[t(i["a"],[t(r["c"],[e._v(" Confirmation ")]),t(r["b"],[e._v(" Are you sure you want to abort this task? This will cancel any related tasks in this project. ")]),t(l["a"]),t(r["a"],[t(c["a"]),t(n["a"],{attrs:{text:""},on:{click:()=>{e.showAbortConfirmation=!1}}},[e._v(" Cancel ")]),t(n["a"],{attrs:{color:"red",text:""},on:{click:()=>{e.showAbortConfirmation=!1,e.abort(e.taskData)}}},[e._v(" Abort ")])],1)],1)],1)],1)},d=[],v=a("2b0e"),p=a("0613"),b={props:{taskName:{type:String,required:!0},formData:{type:Object,required:!1},formDefaults:{type:Object,required:!1},disabled:{type:Boolean,required:!1}},setup(e,{emit:t}){const a=Object(v["ref"])(!1),n=Object(v["ref"])(!1),i=Object(v["ref"])(Object(p["hb"])(e.taskName)),r=Object(v["computed"])(()=>{var t;if(null!==(t=p["Kb"].value)&&void 0!==t&&t.id&&p["D"].value[p["Kb"].value.id])return p["D"].value[p["Kb"].value.id][e.taskName]});Object(v["watch"])(r,async(t,a)=>{void 0===t&&void 0!==a&&(await Object(p["L"])(e.taskName),i.value=Object(p["hb"])(e.taskName))});const s=Object(v["computed"])(()=>e.disabled?e.disabled:!!r.value),l=Object(v["computed"])(()=>!!e.disabled);function o(){t("resetForm")}async function c(t,n=!1){p["Kb"].value&&(!i.value||n?await Object(p["Rb"])(e.taskName,e.formData||{}):a.value=!0)}return{props:e,alreadyDone:i,showSubmissionConfirmation:a,showAbortConfirmation:n,submitDisabled:s,taskData:r,resetForm:o,submitForm:c,abort:p["c"],resetDisabled:l}}},f=b,m=(a("39ac"),a("2877")),g=Object(m["a"])(f,u,d,!1,null,"692056fc",null);t["a"]=g.exports},a5d5:function(e,t,a){},b13f:function(e,t,a){"use strict";a("1726")},bb85:function(e,t,a){},c31b:function(e,t,a){"use strict";a.d(t,"j",(function(){return r})),a.d(t,"i",(function(){return s})),a.d(t,"D",(function(){return l})),a.d(t,"B",(function(){return o})),a.d(t,"C",(function(){return c})),a.d(t,"u",(function(){return u})),a.d(t,"s",(function(){return d})),a.d(t,"y",(function(){return v})),a.d(t,"r",(function(){return p})),a.d(t,"v",(function(){return b})),a.d(t,"h",(function(){return f})),a.d(t,"q",(function(){return m})),a.d(t,"p",(function(){return g})),a.d(t,"t",(function(){return h})),a.d(t,"l",(function(){return _})),a.d(t,"k",(function(){return y})),a.d(t,"o",(function(){return j})),a.d(t,"n",(function(){return O})),a.d(t,"m",(function(){return w})),a.d(t,"d",(function(){return S})),a.d(t,"c",(function(){return x})),a.d(t,"f",(function(){return D})),a.d(t,"g",(function(){return k})),a.d(t,"w",(function(){return P})),a.d(t,"x",(function(){return C})),a.d(t,"b",(function(){return E})),a.d(t,"e",(function(){return M})),a.d(t,"a",(function(){return I})),a.d(t,"A",(function(){return A})),a.d(t,"z",(function(){return T}));a("14d9");var n=a("9baa"),i=a("0613");async function r(e){const t=[];let a=1,i=(await n["a"].get("/datasets",{params:{page:a,search:e}})).data;t.push(...i.results);while(i.next)a+=1,i=(await n["a"].get("/datasets",{params:{page:a,search:e}})).data,t.push(...i.results);return t}async function s(e){return(await n["a"].get("/datasets/"+e)).data}async function l(e,t){return(await n["a"].post(`/datasets/${e}/subset/`,t)).data}async function o(e,t){return(await n["a"].post(`/datasets/${e}/thumbnail/`,{encoding:t})).data}async function c(e,t){return(await n["a"].post(`/projects/${e}/thumbnail/`,{encoding:t})).data}async function u(e){var t;return null===(t=(await n["a"].get("/subjects",{params:{dataset:e}})).data)||void 0===t?void 0:t.results}async function d(e,t){const a=[];let i=1,r=(await n["a"].get("/projects",{params:{page:i,search:e,dataset:t}})).data;a.push(...r.results);while(r.next)i+=1,r=(await n["a"].get("/projects",{params:{page:i,search:e,dataset:t}})).data,a.push(...r.results);return a}async function v(e){return(await n["a"].get("/projects/"+e)).data}async function p(e){const t=await fetch(e);return await t.json()}async function b(e){var t;return null===(t=(await n["a"].get("/task-progress",{params:{project:e}})).data)||void 0===t?void 0:t.results}async function f(e){const t=["image","segmentation","mesh"];return(await Promise.all(t.map(t=>n["a"].get(`/${t}${"mesh"==t?"es":"s"}/`,{params:{subject:e}})))).map((e,a)=>{var n;return null===(n=e.data)||void 0===n?void 0:n.results.map(e=>{const n=t[a];return"image"!==n&&(Object(i["rb"])(n,e.id),Object(i["qb"])(n,e.id)),Object.assign(e,{type:n})})}).flat(2)}async function m(e,t,a){var i;return null===(i=(await n["a"].get("/optimized-particles",{params:{["original_"+e]:t,project:a}})).data)||void 0===i?void 0:i.results}async function g(e,t,a){if("image"!==e){var i;const r=`${e}${"mesh"==e?"es":"s"}`;return null===(i=(await n["a"].get("/groomed-"+r,{params:{[e]:t,project:a}})).data)||void 0===i?void 0:i.results}}async function h(e,t,a){var i;return null===(i=(await n["a"].get("/reconstructed-samples/",{params:{project:a}})).data)||void 0===i?void 0:i.results}async function _(e){var t;return null===(t=(await n["a"].get("/deepssm-result/",{params:{project:e}})).data)||void 0===t?void 0:t.results}async function y(e){var t;return null===(t=(await n["a"].get("/deepssm-aug-pair/",{params:{project:e}})).data)||void 0===t?void 0:t.results}async function j(e){var t;return null===(t=(await n["a"].get("/deepssm-training-pair/",{params:{project:e}})).data)||void 0===t?void 0:t.results}async function O(e){var t;return null===(t=(await n["a"].get("/deepssm-training-image/",{params:{project:e,page_size:100}})).data)||void 0===t?void 0:t.results}async function w(e){var t;return null===(t=(await n["a"].get("/deepssm-testing-data/",{params:{project:e}})).data)||void 0===t?void 0:t.results}async function S(e){return await n["a"].post("/projects/",e)}async function x(e){return await n["a"].post(`/projects/${e}/clone/`)}async function D(e){return await n["a"].delete(`/projects/${e}/`)}async function k(e,t){return await n["a"].put(`/projects/${e}/`,t)}async function P(e,t){return await n["a"].post(`/projects/${e}/groom/`,t)}async function C(e,t){return await n["a"].post(`/projects/${e}/optimize/`,t)}async function E(e,t){return await n["a"].post(`/projects/${e}/analyze/`,t)}async function M(e,t){return await n["a"].post(`/projects/${e}/deepssm-run/`,t)}async function I(e){return(await n["a"].post(`/task-progress/${e}/abort/`)).data}async function A(e,t,a){return(await n["a"].post(`/projects/${e}/landmarks/`,{info:t,locations:a})).data}async function T(e,t){return(await n["a"].post(`/projects/${e}/constraints/`,{locations:t})).data}},cd49:function(e,t,a){"use strict";a.r(t);var n=a("2b0e"),i=a("7496"),r=a("8336"),s=a("b0af"),l=a("99d9"),o=a("132d"),c=a("f6c4"),u=a("a797"),d=a("8e36"),v=function(){var e=this,t=e._self._c;return t(i["a"],[t("nav-bar"),t(c["a"],[t("router-view")],1),t(u["a"],{attrs:{absolute:"",value:!e.oauthClient.isLoggedIn,opacity:.8}},[t(r["a"],{attrs:{color:"primary"},on:{click:e.logIn}},[e._v(" Log in to Continue ")])],1),t(u["a"],{attrs:{absolute:"",value:e.loadingState,opacity:.8}},[t(s["a"],{attrs:{flat:"",width:"200px"}},[t(d["a"],{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)],1),t(u["a"],{attrs:{absolute:"",value:void 0!==e.currentError,opacity:.8}},[t(s["a"],{staticClass:"pa-5"},[t(r["a"],{staticClass:"pa-3",staticStyle:{float:"right"},attrs:{icon:""},on:{click:function(t){t.stopPropagation(),e.currentError=void 0}}},[t(o["a"],[e._v("mdi-close")])],1),t(l["c"],[e._v(" Error: ")]),e.currentError&&e.currentError.length?t(l["b"],[e._v(" "+e._s(e.currentError)+" ")]):t(l["b"],[e._v(" An error has occurred. ")])],1)],1)],1)},p=[],b=a("40dc"),f=a("cd55"),m=a("49e2"),g=a("c865"),h=a("0393"),_=a("adda"),y=a("e449"),j=a("b974"),O=a("2fa4"),w=a("b73d"),S=a("2a7f"),x=function(){var e=this,t=e._self._c;return t(b["a"],{attrs:{app:"",height:"50px"}},[t("div",{staticClass:"d-flex align-center px-5",on:{click:e.navigateToHome}},[t(_["a"],{attrs:{alt:"ShapeWorks Logo",src:"favicon.ico",transition:"scale-transition",width:"55px"}}),t(S["a"],{staticClass:"text-h6"},[e._v("ShapeWorks")])],1),t(O["a"]),e.selectedDataset&&e.selectedProject||e.router.currentRoute.params.dataset&&e.router.currentRoute.params.project?e._e():t("filter-search"),t(y["a"],{attrs:{"offset-y":"","close-on-content-click":!1},scopedSlots:e._u([{key:"activator",fn:function({on:a,attrs:n}){return[e.selectedDataset&&e.selectedProject||e.router.currentRoute.params.dataset&&e.router.currentRoute.params.project?e._e():t(r["a"],e._g(e._b({staticClass:"ma-5",attrs:{hover:"",icon:""}},"v-btn",n,!1),a),[t(o["a"],[e._v(" mdi-filter-variant ")])],1)]}}])},[t(s["a"],[t(h["a"],[t(f["a"],[t(g["a"],[e._v("Sort")]),t(m["a"],[t(l["b"],[t("div",{staticClass:"flex"},[t(j["a"],{attrs:{items:Object.values(e.SORT_OPTION),label:"Sort by"},model:{value:e.sortOption,callback:function(t){e.sortOption=t},expression:"sortOption"}}),t(w["a"],{attrs:{label:e.ascendingLabel},model:{value:e.sortAscending,callback:function(t){e.sortAscending=t},expression:"sortAscending"}})],1)])],1)],1),e.selectedDataset?t(f["a"],[t(g["a"],[e._v("Filter")]),t(m["a"],[t(l["b"],[t(w["a"],{attrs:{label:"Hide private"},model:{value:e.filters.private,callback:function(t){e.$set(e.filters,"private",t)},expression:"filters.private"}}),t(w["a"],{attrs:{label:"Hide read only"},model:{value:e.filters.readonly,callback:function(t){e.$set(e.filters,"readonly",t)},expression:"filters.readonly"}})],1)],1)],1):e._e()],1)],1)],1),t(O["a"]),e.oauthClient.isLoggedIn?t(r["a"],{attrs:{text:""},on:{click:e.logInOrOut}},[e._v(" Logout ")]):e._e()],1)},D=[],k=(a("14d9"),a("9baa")),P=a("0613"),C=a("cc20"),E=a("8654"),M=a("3a2f"),I=function(){var e=this,t=e._self._c;return t(C["a"],[t(E["a"],{attrs:{autofocus:"",rounded:"","hide-details":""},on:{input:e.navigateToResults},scopedSlots:e._u([{key:"prepend-inner",fn:function(){return[t(o["a"],[e._v(" mdi-magnify ")])]},proxy:!0},{key:"append",fn:function(){return[t(M["a"],{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function({on:a,attrs:n}){return[t("span",e._g(e._b({},"span",n,!1),a),[t(o["a"],[e._v(" mdi-information-outline ")])],1)]}}])},[t("span",[e._v("Search ShapeWorks "+e._s(e.selectedDataset?"projects":"datasets")+" by name, description, and keywords")])])]},proxy:!0}]),model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}})],1)},A=[],T=a("5f86"),L={setup(){const e=Object(n["ref"])(T["a"].currentRoute.params.searchText);async function t(){let t="/";P["Jb"].value&&(t=`/dataset/${P["Jb"].value.id}/`),e.value&&(t=t+"search/"+e.value),T["a"].push(t)}return T["a"].beforeEach(async(t,a,n)=>{t.params.searchText?e.value=t.params.searchText:e.value="",n()}),{searchText:e,selectedDataset:P["Jb"],selectedProject:P["Kb"],navigateToResults:t}}},R=L,F=a("2877"),W=Object(F["a"])(R,I,A,!1,null,null,null),N=W.exports,z=a("c31b"),K={components:{FilterSearch:N},setup(){const e=Object(n["computed"])(()=>{var e,t;return{dataset:null===(e=P["Jb"].value)||void 0===e?void 0:e.id,project:null===(t=P["Kb"].value)||void 0===t?void 0:t.id}}),t=Object(n["computed"])(()=>"modified"!==P["Qb"].value?"A to Z":"Oldest");async function a(){k["c"].isLoggedIn?(await Object(k["b"])(),window.location.reload()):k["c"].redirectToLogin()}async function i(){P["Jb"].value=void 0,P["Kb"].value=void 0,"/"!==T["a"].currentRoute.path&&T["a"].push("/"),P["vb"].value=!0,P["e"].value=(await Object(z["j"])(void 0)).sort((e,t)=>e.created<t.created?1:e.created>t.created?-1:0),P["vb"].value=!1}return{oauthClient:k["c"],params:e,logInOrOut:a,selectedDataset:P["Jb"],selectedProject:P["Kb"],navigateToHome:i,sortOption:P["Qb"],sortAscending:P["Pb"],ascendingLabel:t,filters:P["M"],SORT_OPTION:P["b"],router:T["a"]}}},V=K,U=(a("61ca"),Object(F["a"])(V,x,D,!1,null,null,null)),B=U.exports,$={components:{NavBar:B},setup(){const e=()=>{k["c"].redirectToLogin()};return{oauthClient:k["c"],logIn:e,loadingState:P["vb"],currentError:P["B"]}}},G=$,q=(a("59f6"),Object(F["a"])(G,v,p,!1,null,null,null)),J=q.exports,H=a("f309");n["default"].use(H["a"]);var Z=new H["a"]({theme:{dark:!0}});async function Y(){return Object(k["d"])()}Y().then(()=>{new n["default"]({router:T["a"],vuetify:Z,render:e=>e(J)}).$mount("#app")})},ce26:function(module,__webpack_exports__,__webpack_require__){"use strict";var vue__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("2b0e"),vuetify__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("ce5b"),vuetify__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(vuetify__WEBPACK_IMPORTED_MODULE_1__),vuetify_dist_vuetify_min_css__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("bf40"),vuetify_dist_vuetify_min_css__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(vuetify_dist_vuetify_min_css__WEBPACK_IMPORTED_MODULE_2__),_koumoul_vjsf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("fa62"),_koumoul_vjsf__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_koumoul_vjsf__WEBPACK_IMPORTED_MODULE_3__),_koumoul_vjsf_dist_main_css__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("f312"),_koumoul_vjsf_dist_main_css__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_koumoul_vjsf_dist_main_css__WEBPACK_IMPORTED_MODULE_4__),ajv__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("ebd9"),ajv__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(ajv__WEBPACK_IMPORTED_MODULE_5__),json_schema_defaults__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("8275"),json_schema_defaults__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(json_schema_defaults__WEBPACK_IMPORTED_MODULE_6__),_store__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("0613"),_TaskInfo_vue__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("a314");vue__WEBPACK_IMPORTED_MODULE_0__["default"].use(vuetify__WEBPACK_IMPORTED_MODULE_1___default.a),__webpack_exports__["a"]={props:{form:{type:String,required:!0},prerequisite:{type:Function,default:()=>!0},prerequisite_unfulfilled:{type:String,required:!1}},components:{VJsf:_koumoul_vjsf__WEBPACK_IMPORTED_MODULE_3___default(),TaskInfo:_TaskInfo_vue__WEBPACK_IMPORTED_MODULE_8__["a"]},setup(props){const ajv=new ajv__WEBPACK_IMPORTED_MODULE_5___default.a,formDefaults=Object(vue__WEBPACK_IMPORTED_MODULE_0__["ref"])(),formData=Object(vue__WEBPACK_IMPORTED_MODULE_0__["ref"])({}),formSchema=Object(vue__WEBPACK_IMPORTED_MODULE_0__["ref"])(),formValid=Object(vue__WEBPACK_IMPORTED_MODULE_0__["ref"])(!1);function overwriteFormDefaultsFromProjectFile(){var e;const t=null===(e=_store__WEBPACK_IMPORTED_MODULE_7__["Kb"].value)||void 0===e?void 0:e.file_contents;if(t){const e={},a=t=>{t&&Object.entries(t).forEach(([t,a])=>{"True"===a?a=!0:"False"===a?a=!1:"string"!==typeof a||isNaN(parseFloat(a))||(a=parseFloat(a)),e[t]=a})},n=t[props.form];if(n&&"groom"===props.form){const e=Object.values(n)[0];e&&a(e)}else n&&"optimize"===props.form&&a(n);formDefaults.value=Object.fromEntries(Object.entries(formDefaults.value).map(([t,a])=>a?[t,Object.fromEntries(Object.entries(a).map(([t,a])=>e[t]?[t,e[t]]:[t,a]))]:[t,a]))}}async function fetchFormSchema(){let e=props.form;if("groom"===e){const t=_store__WEBPACK_IMPORTED_MODULE_7__["d"].value.map(e=>e.type);t.some(e=>"segmentation"===e)?e+="_segmentation":e+="_mesh"}formSchema.value=await(await fetch(`forms/${e}.json`)).json(),formDefaults.value=json_schema_defaults__WEBPACK_IMPORTED_MODULE_6___default()(formSchema.value),overwriteFormDefaultsFromProjectFile(),formData.value=formDefaults.value}function evaluateExpression(expression){if(expression){const expressionFunc=eval(expression);return expressionFunc(formData.value)}return!0}fetchFormSchema();const schemaOptions={rootDisplay:"expansion-panels",autoFocus:!0,ajv:ajv,sliderProps:{thumbLabel:!0},tooltipProps:{openOnHover:!0,top:!0}};function simplifyFormData(e){let t;return Object.keys(e).forEach(a=>{if(a.includes("section")||a.includes("analysis")){const n=e[a];t={...t,...n}}else t[a]=e[a]}),t}function resetForm(){formData.value=formDefaults.value}return Object(vue__WEBPACK_IMPORTED_MODULE_0__["watch"])(formData,()=>{const e=simplifyFormData(formData.value);"optimize"===props.form?_store__WEBPACK_IMPORTED_MODULE_7__["xb"].value=e:"groom"===props.form&&(_store__WEBPACK_IMPORTED_MODULE_7__["U"].value=e)},{deep:!0}),{props:props,schemaOptions:schemaOptions,formData:formData,formDefaults:formDefaults,formSchema:formSchema,formValid:formValid,simplifyFormData:simplifyFormData,resetForm:resetForm,evaluateExpression:evaluateExpression}}}},d0c6:function(e,t,a){"use strict";a("0401")},dad5:function(e,t,a){"use strict";a.d(t,"e",(function(){return r})),a.d(t,"f",(function(){return s})),a.d(t,"d",(function(){return l})),a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return c})),a.d(t,"c",(function(){return u}));var n=a("2b0e"),i=a("0613");const r=Object(n["ref"])([{name:"Original",color:"white",rgb:[1,1,1],available:()=>!0},{name:"Groomed",color:"green",rgb:[0,1,0],available:()=>Object.values(i["V"].value).map(e=>Object.values(e).flat()).flat().length>0},{name:"Reconstructed",color:"red",rgb:[1,0,0],available:()=>{var e;return(null===(e=i["Eb"].value)||void 0===e?void 0:e.length)>0}},{name:"Particles",color:void 0,rgb:void 0,available:()=>Object.values(i["Ab"].value).map(e=>Object.values(e).flat()).flat().length>0},{name:"Landmarks",color:void 0,rgb:void 0,available:()=>{var e;return(null===(e=i["Kb"].value)||void 0===e?void 0:e.landmarks_info)&&i["Kb"].value.landmarks_info.length>0}},{name:"Constraints",color:void 0,rgb:void 0,available:()=>{var e;return(null===(e=i["Kb"].value)||void 0===e?void 0:e.constraints)&&i["Kb"].value.constraints.length>0}}]),s=Object(n["ref"])({Original:[],"Original - Image":[],Groomed:[],Reconstructed:[],Particles:[],DeepSSM:[]}),l=32,o=[[166,206,227],[31,120,180],[178,223,138],[51,160,44],[251,154,153],[227,26,28],[253,191,111],[255,127,0],[202,178,214],[106,61,154],[255,255,153],[177,89,40]],c=12;var u;(function(e){e["NAME"]="name",e["ID"]="id",e["MODIFIED"]="modified",e["CREATOR"]="creator"})(u||(u={}))},db11:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));a("14d9");function n(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function i(e,t){return[e[0]+t[0],e[1]+t[1],e[2]+t[2]]}function r(e,t){return[e[0]-t[0],e[1]-t[1],e[2]-t[2]]}function s(e){const t=Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2));return[e[0]/t,e[1]/t,e[2]/t]}function l(e,t){const a={};return t.forEach(r=>{const s=t.filter(e=>e.type===r.type&&e.domain===r.domain).findIndex(e=>e.id===r.id),l=e.filter(e=>e.type===r.type);if(l.length<=s)return;const o=l[s];if("plane"===r.type){a.planes||(a.planes=[]);const{origin:e,normal:t}=o.data,s=n(t,[1,0,0]),l=n(t,[0,1,0]),c=e,u=i(e,t[2]>0?l:s),d=i(e,t[2]>0?s:l),v={points:[c,u,d]};r.name&&(v.name=r.name),a.planes.push(v)}else if("paint"===r.type){const e=o.data;r.name&&(e.name=r.name),a.free_form_constraints=e}}),a}t["b"]=async function(e){const t=[];if(e){var a;const i=await fetch(e),l=await i.json();null===(a=l.planes)||void 0===a||a.forEach(({points:e,name:a})=>{if(e&&3===e.length){const[i,l,o]=e,c=r(i,o),u=r(i,l),d=s(n(c,u)),v=i;t.push({type:"plane",data:{origin:v,normal:d},name:a})}}),l.free_form_constraints&&t.push({type:"paint",data:l.free_form_constraints,name:l.free_form_constraints.name})}return t}},e5b9:function(e,t,a){},edc1:function(e,t,a){"use strict";a("06eb")},f525:function(e,t,a){}});
//# sourceMappingURL=app.90c4e9a4.js.map